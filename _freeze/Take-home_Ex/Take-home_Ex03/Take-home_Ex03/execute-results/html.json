{
  "hash": "eaca06a35664e836c3e6e769ee76c107",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 3: Prototyping Modules for Geospatial Analytics Shiny Application\"\nformat: \n  html: \n    code-fold: true\n    code-summary: \"Show the code\"\nexecute:\n  freeze: true\n  warning: false\neditor: visual\ndate: \"March 24, 2024\"\n---\n\n\n# 1 Overview\n\n## 1.1 Background\n\nSingapore is experiencing an ageing population, with an increasing proportion of the citizens aged 65 and older [by 11.7% compared to 10 years ago](https://www.cnbc.com/2023/10/30/as-singapores-aging-population-grows-businesses-court-older-spenders.html). In addition, the life expectancy of Singaporeans has been steadily [rising over the past five decades](https://smartwealth.sg/life-expectancy/). This has prompted the government to commit to building more eldercare facilities nationwide. Alongside this has come a push for [Active Ageing](https://www.moh.gov.sg/ifeelyoungsg/how-can-i-age-actively/stay-healthy/active-ageing-programmes) to encourage the elderly to “stay active, healthy and socially engaged”. To achieve this goal, the government has also been trying to [increase the number of active ageing centres](https://www.straitstimes.com/singapore/politics/ndr-2023-active-ageing-centres-to-be-expanded-to-help-seniors-stay-active-and-healthy) and possible locations for activities to make it more accessible to seniors.\n\nOur project would like to understand what the current distribution of eldercare facilities and amenities is across Singapore and selected planning areas within Singapore. We want to investigate whether there are enough facilities and amenities to ensure that the elderly not just age healthily, but age well. We also want to understand whether the facilities are spatially randomly distributed, and whether they are accessible from places of demand. In this particular take-home exercise, out focus will be on the accesibility of the following facilities from residential areas of elderly demand:\n\nEldercare centres: Shared places of activities and bonding targeted at the elderly\n\nCommunity gardens: Community gardens where the elderly can pursue their gardening hobbies, or hang out with other residents\n\nCommunity Centres: Shared places in the residential area, where residents from different walks can and bond over activities. There are activities targeted specifically at the elderly, such as cooking workshops and dancing classes, helping them maintain\n\nParks: Shared public places where the elderly can engage in outdoor physical activities to maintain an active lifestyle\n\nCHAS clinics: Clinics with CHAS (Community Health Assist Scheme), which allow eligible elderly to get access to medical services at subsidized rates.\n\nHospitals: Hospitals that provide more thorough and comprehensive health services to the elderly.\n\n## 1.2 Objectives\n\nIn this take-home exercise, our objective is to model geographical accessibility of the abovementioned 6 facilities relevant to the elderly using R's geospatial analysis packages.\n\n## 1.3 The Task\n\nThrough this exercise, we will conduct the following procedures\n\n-   Install and load relevant R packages\n\n-   Import data of various formats (shapefile, geojson, kml, csv)\n\n-   Clean and wrangle data into our desired formats\n\n-   Compute accessibility measure using Hansen's potential model, KD2SFCA model, and Spatial Accessibility Method\n\n-   Visualize accessibility measures using tmap and ggplot2 packages\n\n## 1.4 The Data\n\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n| Dataset                                                                                                                                                                                                      | Notes                                                                                                                                            |\n+==============================================================================================================================================================================================================+==================================================================================================================================================+\n| [Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2023](https://www.singstat.gov.sg/-/media/files/find_data/population/statistical_tables/respopagesextod2023.ashx) | -   Source: Department of Statistics, Singapore                                                                                                  |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Content: Attribute data containing the number of Singapore residents by planning area, subzone, age group, sex and type of dwelling, in 2023 |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Type: Polygon Data                                                                                                                           |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Format: csv                                                                                                                                  |\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n| [Master Plan 2019 Subzone Boundary (No Sea)](https://beta.data.gov.sg/collections/1749/view)                                                                                                                 | -   Source: Urban Redevelopment Authority (URA)                                                                                                  |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Content: Geospatial data containing Singapore subzones, planning areas, and regions                                                          |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Type: Polygon Data                                                                                                                           |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Format: geojson                                                                                                                              |\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n| [Eldercare Services](https://beta.data.gov.sg/collections/714/datasets/d_3545b068e3f3506c56b2cb6b6117b884/view)                                                                                              | -   Source: Ministry of Health, Singapore                                                                                                        |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Content: Geospatial and attribute data containing the records of eldercare services in Singapore as of February 29, 2024                     |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Type: Point Data                                                                                                                             |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Format: shapefile                                                                                                                            |\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n| [Pois Data Set](https://download.geofabrik.de/)                                                                                                                                                              | -   Source: OpenStreetMap of Geofabrik server                                                                                                    |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Content: Facilties in Malaysia, Singapore and Brunei (e.g. parks, community centres, hospital)                                               |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Type: Polygon Data                                                                                                                           |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Format: shapefile                                                                                                                            |\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n| [Community in Bloom](https://beta.data.gov.sg/collections/1479/view) (CIB)                                                                                                                                   | -   Source: National Parks Board, Singapore                                                                                                      |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Content: Community gardens in Singapore                                                                                                      |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Type: Point Data                                                                                                                             |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Format: kml                                                                                                                                  |\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n| [CHAS clinics](https://beta.data.gov.sg/collections/2036/view)                                                                                                                                               | -   Source: Ministry of Health, Singapore                                                                                                        |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Content: CHAS clinics in Singapore                                                                                                           |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Type: Point Data                                                                                                                             |\n|                                                                                                                                                                                                              |                                                                                                                                                  |\n|                                                                                                                                                                                                              | -   Format: geojson                                                                                                                              |\n+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+\n\n## 1.5 Installing and Loading R Packages\n\nIn this exercise, the following R packages would be used:\n\nThen, to install and/or load the R packages, we can use p_load() from the **pacman** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, tmap, SpatialAcc, ggplot2, ggstatsplot, sp, reshape2)\n```\n:::\n\n\n# 2 Data Preparation (Geospatial)\n\n## 2.1 Data Import\n\nLet’s begin by introducing and preparing our geospatial data set in R!\n\nTo import geospatial data, we will be using st_read() from the **sf** package.\n\n### 2.1.1 Master Plan 2019\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz2019 <- st_read(\"data/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz2019\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 10 features:\n     Name\n1   kml_1\n2   kml_2\n3   kml_3\n4   kml_4\n5   kml_5\n6   kml_6\n7   kml_7\n8   kml_8\n9   kml_9\n10 kml_10\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Description\n1          <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>12</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>DEPOT ROAD</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ12</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>C22DED671DE2A940</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n2          <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>2</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ02</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>085EF219A5A1AEAD</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n3                 <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>3</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>CHINATOWN</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>OTSZ03</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>OUTRAM</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>OT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>EF2B9A91AF49E025</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n4            <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>4</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>PHILLIP</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ04</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>615D4EDDEF809F8E</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n5      <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>5</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>RAFFLES PLACE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ05</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>72107B11807074F4</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n6              <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>4</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>CHINA SQUARE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>OTSZ04</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>OUTRAM</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>OT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>B609DF5587626C8F</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n7         <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>10</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>TIONG BAHRU</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ10</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>A0FB4B68155D164A</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n8  <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>12</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>BAYFRONT SUBZONE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ12</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>197F5E664DA4D5E1</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n9  <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>4</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>TIONG BAHRU STATION</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ04</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>91FFE927ABE3E4DB</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n10     <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>6</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>CLIFFORD PIER</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ06</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>945CC212CA80626F</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n                         geometry\n1  MULTIPOLYGON Z (((103.8145 ...\n2  MULTIPOLYGON Z (((103.8221 ...\n3  MULTIPOLYGON Z (((103.8438 ...\n4  MULTIPOLYGON Z (((103.8496 ...\n5  MULTIPOLYGON Z (((103.8525 ...\n6  MULTIPOLYGON Z (((103.8486 ...\n7  MULTIPOLYGON Z (((103.8311 ...\n8  MULTIPOLYGON Z (((103.8589 ...\n9  MULTIPOLYGON Z (((103.8283 ...\n10 MULTIPOLYGON Z (((103.8552 ...\n```\n:::\n:::\n\n\nFrom the above, we can see that the **mpsz2019** data is a multipolygon data in geodetic CRS WGS84, with Z dimensions.\n\n### 2.1.2 Eldercare services\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services <- st_read(dsn = \"/Users/binhui-ong/IS415-GAA/Take-home_Ex/Take-home_Ex03/data\",\n                              layer = \"ELDERCARE\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID ADDRESSBLO ADDRESSBUI ADDRESSPOS\n1         1       <NA>       <NA>     601318\n2         2       <NA>       <NA>     462509\n3         3       <NA>       <NA>     640190\n4         4       <NA>       <NA>     190005\n5         5       <NA>       <NA>     160044\n6         6       <NA>       <NA>     160117\n7         7       <NA>       <NA>     523499\n8         8       <NA>       <NA>     731569\n9         9       <NA>       <NA>     651210\n10       10       <NA>       <NA>     540182\n                              ADDRESSSTR ADDRESSTYP DESCRIPTIO HYPERLINK\n1      318A Jurong East Avenue 1 #02-308       <NA>       <NA>      <NA>\n2  Blk 509B Bedok North Street 3 #02-157       <NA>       <NA>      <NA>\n3         Blk 190 Boon Lay Drive #01-242       <NA>       <NA>      <NA>\n4                    5 Beach Rd #02-4943       <NA>       <NA>      <NA>\n5             Blk 44 Beo Crescent #01-67       <NA>       <NA>      <NA>\n6     Blk 117 Jalan Bukit Merah #01-1683       <NA>       <NA>      <NA>\n7            499C Tampines Ave 9 #01-256       <NA>       <NA>      <NA>\n8              569A Champion Way #01-346       <NA>       <NA>      <NA>\n9         210A Bukit Batok St 21 #01-294       <NA>       <NA>      <NA>\n10   Blk 182 Rivervale Crescent\\n#01-311       <NA>       <NA>      <NA>\n   LANDXADDRE LANDYADDRE\n1           0          0\n2           0          0\n3           0          0\n4           0          0\n5           0          0\n6           0          0\n7           0          0\n8           0          0\n9           0          0\n10          0          0\n                                                           NAME PHOTOURL\n1                                  Yuhua Senior Activity Centre     <NA>\n2                                          THK SAC @ Kaki Bukit     <NA>\n3                                            THK SAC @ Boon Lay     <NA>\n4                        PEACE-Connect Senior Activity Centre@5     <NA>\n5                                        THK SAC @ Beo Crescent     <NA>\n6                                      Silver ACE @ Bukit Merah     <NA>\n7  Lions Befrienders Senior Activity Centre @ Tampines Blk 499C     <NA>\n8                    Care Corner Senior Activity Centre (WL569)     <NA>\n9           Fei Yue Senior Activity Centre (Bukit Batok Branch)     <NA>\n10       COMNET Senior Activity Centre @ 182 Rivervale Crescent     <NA>\n   ADDRESSFLO          INC_CRC FMEL_UPD_D ADDRESSUNI   X_ADDR   Y_ADDR\n1        <NA> 2B0DB92FDD914FFC 2016-07-28       <NA> 16614.08 36639.12\n2        <NA> 82728FA30612F3FD 2016-07-28       <NA> 38803.81 35098.78\n3        <NA> DE7A8D4EA0BD1D9B 2016-07-28       <NA> 14481.92 36357.61\n4        <NA> A2C058FC5785F7FE 2016-07-28       <NA> 31505.35 31853.52\n5        <NA> 9DBFD51E056AEE70 2016-07-28       <NA> 27218.35 30135.49\n6        <NA> 169DABA5B6ECEA87 2016-07-28       <NA> 27278.94 29350.17\n7        <NA> 5DB6B9F0BF276F6D 2016-07-28       <NA> 41665.14 37956.92\n8        <NA> 4DC6800E9BB385BE 2016-07-28       <NA> 23147.94 45761.17\n9        <NA> EFBD712DA5DD6FEC 2016-07-28       <NA> 18820.58 36396.32\n10       <NA> 6BB0D7698D7B4C7D 2016-07-28       <NA> 36446.37 41376.90\n                    geometry\n1  POINT (16614.08 36639.12)\n2  POINT (38803.81 35098.78)\n3  POINT (14481.92 36357.61)\n4  POINT (31505.35 31853.52)\n5  POINT (27218.35 30135.49)\n6  POINT (27278.94 29350.17)\n7  POINT (41665.14 37956.92)\n8  POINT (23147.94 45761.17)\n9  POINT (18820.58 36396.32)\n10  POINT (36446.37 41376.9)\n```\n:::\n:::\n\n\nThe eldercare_services data set is point data, with dimensions XY and CRS SVY21.\n\n### 2.1.3 Community Gardens\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngardensg <- st_read(dsn = \"/Users/binhui-ong/IS415-GAA/Take-home_Ex/Take-home_Ex03/data/CommunityinBloomCIB.kml\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngardensg\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 1586 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6337 ymin: 1.247904 xmax: 103.9901 ymax: 1.46195\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                                                                 Name\n1                                  Boon Lay Zone F Residents' Network\n2                       Bishan Home (For The Intellectually Disabled)\n3              Lion's Home for the Elders (Bishan) Senior Care Centre\n4                                          Zion Kindergarten (Bishan)\n5                             Macpherson Zone B  Residents' Committee\n6                               Kuo Chuan Presbyterian Primary School\n7                        Toa Payoh East Zone '5' Residents' Committee\n8                              CHIJ Katong Convent (Secondary) School\n9                             Kuo Chuan Presbyterian Secondary School\n10 Tampines Grace RN (Greenlace, Greenforest, Green Flora & Tapestry)\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Description\n1                                                                           <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Boon Lay Zone F Residents' Network</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>1</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Boon Lay Zone F Residents' Network</td> </tr> <tr> <td>LATITUDE</td> <td>1.344691</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.702112</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n2                                                     <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Bishan Home (For The Intellectually Disabled)</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>2</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Bishan Home (For The Intellectually Disabled)</td> </tr> <tr> <td>LATITUDE</td> <td>1.347525</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.854656</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n3                                   <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Lion's Home for the Elders (Bishan) Senior Care Centre</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>3</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Lion's Home for the Elders (Bishan) Senior Care Centre</td> </tr> <tr> <td>LATITUDE</td> <td>1.349261</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.853511</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n4                                                                                           <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Zion Kindergarten (Bishan)</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>4</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Zion Kindergarten (Bishan)</td> </tr> <tr> <td>LATITUDE</td> <td>1.347374</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.854621</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n5                                                                 <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Macpherson Zone B  Residents' Committee</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>5</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Macpherson Zone B  Residents' Committee</td> </tr> <tr> <td>LATITUDE</td> <td>1.327456</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.887222</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n6                                                                     <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Kuo Chuan Presbyterian Primary School</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>6</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Kuo Chuan Presbyterian Primary School</td> </tr> <tr> <td>LATITUDE</td> <td>1.349116</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.854727</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n7                                                        <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Toa Payoh East Zone '5' Residents' Committee</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>7</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Toa Payoh East Zone '5' Residents' Committee</td> </tr> <tr> <td>LATITUDE</td> <td>1.331044</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.85903</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n8                                                                    <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>CHIJ Katong Convent (Secondary) School</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>8</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>CHIJ Katong Convent (Secondary) School</td> </tr> <tr> <td>LATITUDE</td> <td>1.306593</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.91739</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n9                                                                 <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Kuo Chuan Presbyterian Secondary School</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>9</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Kuo Chuan Presbyterian Secondary School</td> </tr> <tr> <td>LATITUDE</td> <td>1.350135</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.854907</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n10 <html xmlns:fo=\"http://www.w3.org/1999/XSL/Format\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"> <head> <META http-equiv=\"Content-Type\" content=\"text/html\"> <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"> </head> <body style=\"margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;\"> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px\"> <tr style=\"text-align:center;font-weight:bold;background:#9CBCE2\"> <td>Tampines Grace RN (Greenlace, Greenforest, Green Flora &amp; Tapestry)</td> </tr> <tr> <td> <table style=\"font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px\"> <tr> <td>GARDENID</td> <td>10</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>GARDEN_NAME</td> <td>Tampines Grace RN (Greenlace, Greenforest, Green Flora &amp; Tapestry)</td> </tr> <tr> <td>LATITUDE</td> <td>1.356087</td> </tr> <tr bgcolor=\"#D4E4F3\"> <td>LONGITUDE</td> <td>103.931752</td> </tr> </table> </td> </tr> </table> </body><script type=\"text/javascript\"> function changeImage(attElement, nameElement) { document.getElementById('imageAttachment').src = attElement; document.getElementById('imageName').innerHTML = nameElement;} </script></html>\n                        geometry\n1  POINT Z (103.7021 1.344691 0)\n2  POINT Z (103.8547 1.347525 0)\n3  POINT Z (103.8535 1.349261 0)\n4  POINT Z (103.8546 1.347374 0)\n5  POINT Z (103.8872 1.327456 0)\n6  POINT Z (103.8547 1.349116 0)\n7   POINT Z (103.859 1.331044 0)\n8  POINT Z (103.9174 1.306593 0)\n9  POINT Z (103.8549 1.350135 0)\n10 POINT Z (103.9318 1.356087 0)\n```\n:::\n:::\n\n\nWe see that the **gardens** data set is of point data type, has XYZ dimension, and CRS is WGS84.\n\n### 2.1.4 CHAS clinics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchassg <- st_read(\"/Users/binhui-ong/IS415-GAA/Take-home_Ex/Take-home_Ex03/data/CHASClinics.geojson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `CHASClinics' from data source \n  `/Users/binhui-ong/IS415-GAA/Take-home_Ex/Take-home_Ex03/data/CHASClinics.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1193 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.5818 ymin: 1.016264 xmax: 103.9903 ymax: 1.456037\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchassg\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 1193 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.5818 ymin: 1.016264 xmax: 103.9903 ymax: 1.456037\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 10 features:\n     Name\n1   kml_1\n2   kml_2\n3   kml_3\n4   kml_4\n5   kml_5\n6   kml_6\n7   kml_7\n8   kml_8\n9   kml_9\n10 kml_10\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Description\n1                               <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>15M0211</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Acumed Medical Group</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>68615755</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>629117</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>B</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>1</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>23</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>JOO KOON CIRCLE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>FAIRPRICE HUB</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>10760.19030171</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>34206.12386783</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>781AF3FC7E4D0301</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n2  <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>16M0004</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Acumed Medical Group</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>65701390</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>637370</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>B</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>128</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>03</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>TUAS SOUTH AVENUE 3</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>JTC BIOMED ONE @ TUAS BIOMEDICAL PARK</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>4985.53397365</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>30167.98804538</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>4132D1A643933D75</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n3                                   <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>21M0229</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Advantage Medical Clinic</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>87840093</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>268802</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>B</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>1</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>03</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>12</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>FIFTH AVENUE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>GUTHRIE HOUSE</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CHAS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>23812.58956922</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>34780.57533007</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>1429766D7056AA8D</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n4                          <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>19M0160</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Affinity Medical Clinic</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>62808080</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>550253</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>A</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>253</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>187</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>SERANGOON CENTRAL DRIVE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td></td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS,ISP</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>32176.99089858</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>37348.34529089</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>25E32F8453AEABFD</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n5        <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>9404401</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Allergy, Arthritis & Rheumatism Clinic</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MD</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>64749438</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>217562</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>B</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>1</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>14</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>13</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>FARRER PARK STATION ROAD</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>CONNEXION</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>30293.80179285</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>32752.14975386</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>E04B63460D9DF892</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n6                                        <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>17M0228</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Allhealth Family Clinic</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>67026467</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>523872</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>A</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>872C</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>01</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>TAMPINES STREET 86</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td></td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CHAS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>38940.52504647</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>37479.79536068</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>5B0B49E22956F1B3</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n7                                          <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>19M0341</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Ally Health</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>66977700</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>140462</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>A</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>46-2</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>372</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>COMMONWEALTH DRIVE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td></td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS,ISP</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>24094.68699586</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>31368.73817961</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>C5F9B14203C0367F</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n8       <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>16M0043</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Ang Mo Kio Family Medicine Clinic</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>65541133</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>569841</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>4190</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>03</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>01</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>ANG MO KIO AVENUE 6</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>BROADWAY PLAZA</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS,ISP</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>29405.66118025</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>39327.37454678</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>4A712102C8E400A3</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n9                            <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>16C0397</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Anteh Dispensary Pte Ltd</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>67440040</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>398664</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td></td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>1</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>02</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>LORONG 22 GEYLANG</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>GRANDVIEW SUITES</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CHAS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>33468.48699051</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>32785.67660058</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>7E06EFB3781F029E</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n10        <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>HCI_CODE</th> <td>20M0227</td> </tr><tr bgcolor=\"\"> <th>HCI_NAME</th> <td>Appletree Medical Centre</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>LICENCE_TYPE</th> <td>MC</td> </tr><tr bgcolor=\"\"> <th>HCI_TEL</th> <td>64548361</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>POSTAL_CD</th> <td>560416</td> </tr><tr bgcolor=\"\"> <th>ADDR_TYPE</th> <td>A</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BLK_HSE_NO</th> <td>416</td> </tr><tr bgcolor=\"\"> <th>FLOOR_NO</th> <td>01</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>UNIT_NO</th> <td>997</td> </tr><tr bgcolor=\"\"> <th>STREET_NAME</th> <td>ANG MO KIO AVENUE 10</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>BUILDING_NAME</th> <td>TECK GHEE HEARTLANDS</td> </tr><tr bgcolor=\"\"> <th>CLINIC_PROGRAMME_CODE</th> <td>CDMP,CHAS,ISP</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>X_COORDINATE</th> <td>30424.4244873</td> </tr><tr bgcolor=\"\"> <th>Y_COORDINATE</th> <td>38509.61595566</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>68380F0447C3CEAD</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20210926121846</td> </tr></table></center>\n                        geometry\n1  POINT Z (103.6784 1.325618 0)\n2  POINT Z (103.6265 1.289095 0)\n3  POINT Z (103.7957 1.330817 0)\n4  POINT Z (103.8709 1.354039 0)\n5  POINT Z (103.8539 1.312473 0)\n6  POINT Z (103.9316 1.355226 0)\n7  POINT Z (103.7982 1.299962 0)\n8  POINT Z (103.8459 1.371937 0)\n9  POINT Z (103.8825 1.312776 0)\n10 POINT Z (103.8551 1.364542 0)\n```\n:::\n:::\n\n\nWe see that the **chassg** data set is of point data type, has XYZ dimension, and CRS is WGS84.\n\n### 2.1.5 Other amenities (Hospitals, Community Centres, Parks)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nother_amenities <- st_read(dsn = \"/Users/binhui-ong/IS415-GAA/Take-home_Ex/Take-home_Ex03/data\",\n                              layer = \"gis_osm_pois_a_free_1\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nother_amenities\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 54002 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 99.66072 ymin: 0.9760554 xmax: 119.0104 ymax: 7.510638\nGeodetic CRS:  WGS 84\nFirst 10 features:\n     osm_id code        fclass                 name\n1  10085141 2721    attraction  Tukun Batu Feringgi\n2   7979589 2204          park      Japanese Garden\n3  10590000 2204          park            KLCC Park\n4  16892550 2204          park    Fort Canning Park\n5  19206050 2501   supermarket                Mydin\n6  19207509 2256       stadium     Stadium Malawati\n7  19207529 2256       stadium    Stadium Shah Alam\n8  19800584 2501   supermarket              Lotus's\n9  20066960 2251 sports_centre Shah Alam Cart Track\n10 20125866 2084       college                PTPTL\n                         geometry\n1  MULTIPOLYGON (((100.2353 5....\n2  MULTIPOLYGON (((100.3015 5....\n3  MULTIPOLYGON (((101.7122 3....\n4  MULTIPOLYGON (((103.8439 1....\n5  MULTIPOLYGON (((101.5156 3....\n6  MULTIPOLYGON (((101.5466 3....\n7  MULTIPOLYGON (((101.5452 3....\n8  MULTIPOLYGON (((101.5379 3....\n9  MULTIPOLYGON (((101.5424 3....\n10 MULTIPOLYGON (((101.5427 3....\n```\n:::\n:::\n\n\nWe see that the **other_amenities** data is point data, with dimensions XY and CRS WGS84.\n\n## 2.2 Visualization of imported data\n\nLet's visualize how it looks like using plot() and st_geometry() from the **sf** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(mpsz2019))\n```\n:::\n\n\n![](images/mpsz2019.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(eldercare_services))\n```\n:::\n\n\n![](images/eldercare_services.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(gardensg))\n```\n:::\n\n\n![](images/gardensg.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(chassg))\n```\n:::\n\n\n![](images/chassg.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(other_amenities))\n```\n:::\n\n\n![](images/other_amenities.png)\n\n## 2.3 Data Pre-Processing\n\n### 2.3.1 Dropping Z-dimension\n\nEarlier, we established that **mpsz**, **gardens** and **chassg** contain the Z-dimension.\n\nTo remove the Z-dimension which would potentially hinder our analysis, we can use st_zm() from **sf** package as shown in the codes below.\n\nFor mpsz2019,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_zm(mpsz2019)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nFor gardens,\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngardens <- st_zm(gardensg)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nFor chassg,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas_sg <- st_zm(chassg)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 2.3.2 Resolving invalid geometries\n\nTo check for invalid geometries, we can apply the following codes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(mpsz) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(eldercare_services) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(gardens) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(chas_sg) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(other_amenities) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\nAmong all of the geospatial data, only mpsz has invalid geometries. To resolve the invalid geometry, we use st_make_valid() from **sf** package as shown in the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_make_valid(mpsz)\n```\n:::\n\n\nNow, let's check the result.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(mpsz) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\nNice, all our geospatial data consist of fully valid geometries now!\n\n### 2.2.3 Handling missing values\n\nHere, we can apply the following codes to check for missing values in our data sets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz[rowSums(is.na(mpsz)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 2 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nGeodetic CRS:  WGS 84\n[1] Name        Description geometry   \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services[rowSums(is.na(eldercare_services)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID ADDRESSBLO ADDRESSBUI ADDRESSPOS\n1         1       <NA>       <NA>     601318\n2         2       <NA>       <NA>     462509\n3         3       <NA>       <NA>     640190\n4         4       <NA>       <NA>     190005\n5         5       <NA>       <NA>     160044\n6         6       <NA>       <NA>     160117\n7         7       <NA>       <NA>     523499\n8         8       <NA>       <NA>     731569\n9         9       <NA>       <NA>     651210\n10       10       <NA>       <NA>     540182\n                              ADDRESSSTR ADDRESSTYP DESCRIPTIO HYPERLINK\n1      318A Jurong East Avenue 1 #02-308       <NA>       <NA>      <NA>\n2  Blk 509B Bedok North Street 3 #02-157       <NA>       <NA>      <NA>\n3         Blk 190 Boon Lay Drive #01-242       <NA>       <NA>      <NA>\n4                    5 Beach Rd #02-4943       <NA>       <NA>      <NA>\n5             Blk 44 Beo Crescent #01-67       <NA>       <NA>      <NA>\n6     Blk 117 Jalan Bukit Merah #01-1683       <NA>       <NA>      <NA>\n7            499C Tampines Ave 9 #01-256       <NA>       <NA>      <NA>\n8              569A Champion Way #01-346       <NA>       <NA>      <NA>\n9         210A Bukit Batok St 21 #01-294       <NA>       <NA>      <NA>\n10   Blk 182 Rivervale Crescent\\n#01-311       <NA>       <NA>      <NA>\n   LANDXADDRE LANDYADDRE\n1           0          0\n2           0          0\n3           0          0\n4           0          0\n5           0          0\n6           0          0\n7           0          0\n8           0          0\n9           0          0\n10          0          0\n                                                           NAME PHOTOURL\n1                                  Yuhua Senior Activity Centre     <NA>\n2                                          THK SAC @ Kaki Bukit     <NA>\n3                                            THK SAC @ Boon Lay     <NA>\n4                        PEACE-Connect Senior Activity Centre@5     <NA>\n5                                        THK SAC @ Beo Crescent     <NA>\n6                                      Silver ACE @ Bukit Merah     <NA>\n7  Lions Befrienders Senior Activity Centre @ Tampines Blk 499C     <NA>\n8                    Care Corner Senior Activity Centre (WL569)     <NA>\n9           Fei Yue Senior Activity Centre (Bukit Batok Branch)     <NA>\n10       COMNET Senior Activity Centre @ 182 Rivervale Crescent     <NA>\n   ADDRESSFLO          INC_CRC FMEL_UPD_D ADDRESSUNI   X_ADDR   Y_ADDR\n1        <NA> 2B0DB92FDD914FFC 2016-07-28       <NA> 16614.08 36639.12\n2        <NA> 82728FA30612F3FD 2016-07-28       <NA> 38803.81 35098.78\n3        <NA> DE7A8D4EA0BD1D9B 2016-07-28       <NA> 14481.92 36357.61\n4        <NA> A2C058FC5785F7FE 2016-07-28       <NA> 31505.35 31853.52\n5        <NA> 9DBFD51E056AEE70 2016-07-28       <NA> 27218.35 30135.49\n6        <NA> 169DABA5B6ECEA87 2016-07-28       <NA> 27278.94 29350.17\n7        <NA> 5DB6B9F0BF276F6D 2016-07-28       <NA> 41665.14 37956.92\n8        <NA> 4DC6800E9BB385BE 2016-07-28       <NA> 23147.94 45761.17\n9        <NA> EFBD712DA5DD6FEC 2016-07-28       <NA> 18820.58 36396.32\n10       <NA> 6BB0D7698D7B4C7D 2016-07-28       <NA> 36446.37 41376.90\n                    geometry\n1  POINT (16614.08 36639.12)\n2  POINT (38803.81 35098.78)\n3  POINT (14481.92 36357.61)\n4  POINT (31505.35 31853.52)\n5  POINT (27218.35 30135.49)\n6  POINT (27278.94 29350.17)\n7  POINT (41665.14 37956.92)\n8  POINT (23147.94 45761.17)\n9  POINT (18820.58 36396.32)\n10  POINT (36446.37 41376.9)\n```\n:::\n:::\n\n\nSeems like **eldercare_services** contain missing values in all rows, likely attributed to certain columns that consist of fully NA values. Let's focus on checking only the relevant columns, NAME and geometry.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services[rowSums(is.na(eldercare_services %>% select(11,19))) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 18 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: SVY21\n [1] OBJECTID   ADDRESSBLO ADDRESSBUI ADDRESSPOS ADDRESSSTR ADDRESSTYP\n [7] DESCRIPTIO HYPERLINK  LANDXADDRE LANDYADDRE NAME       PHOTOURL  \n[13] ADDRESSFLO INC_CRC    FMEL_UPD_D ADDRESSUNI X_ADDR     Y_ADDR    \n[19] geometry  \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n\nYay, they seem to be alright!\n\nThen, we continue checking the other data sets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngardens[rowSums(is.na(gardens)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 2 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nGeodetic CRS:  WGS 84\n[1] Name        Description geometry   \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchas_sg[rowSums(is.na(chas_sg)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 2 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nGeodetic CRS:  WGS 84\n[1] Name        Description geometry   \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nother_amenities[rowSums(is.na(other_amenities)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 29715 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 99.66072 ymin: 1.013643 xmax: 119.0104 ymax: 7.253331\nGeodetic CRS:  WGS 84\nFirst 10 features:\n     osm_id code     fclass name                       geometry\n13 20126093 2084    college <NA> MULTIPOLYGON (((101.5421 3....\n15 20505251 2204       park <NA> MULTIPOLYGON (((101.5582 3....\n16 21281773 2205 playground <NA> MULTIPOLYGON (((101.5577 3....\n19 22945204 2306 food_court <NA> MULTIPOLYGON (((101.7946 2....\n20 22998331 2256    stadium <NA> MULTIPOLYGON (((101.5466 3....\n25 23033750 2204       park <NA> MULTIPOLYGON (((101.5195 3....\n28 23036984 2204       park <NA> MULTIPOLYGON (((101.5379 3....\n29 23037034 2204       park <NA> MULTIPOLYGON (((101.5467 3....\n34 23043243 2204       park <NA> MULTIPOLYGON (((101.507 3.0...\n41 23046326 2252      pitch <NA> MULTIPOLYGON (((101.5028 3....\n```\n:::\n:::\n\n\nSimilarly, **other_amenities** contain NA values in many rows. From the output, we can attribute it to the name column. Let's exclude the name column in our check:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nother_amenities[rowSums(is.na(other_amenities %>% select(-name))) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 4 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nGeodetic CRS:  WGS 84\n[1] osm_id   code     fclass   name     geometry\n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n\nExcluding the name column, which is not very important for our analysis, we can conclude that there is no other missing values.\n\nWe're done with handling the missing values in our geospatial data!\n\n### 2.3.4 Changing and verifying CRS\n\nIt is very important to ensure our geospatial data is in the appropriate and common CRS. To check for crs of each data set, we can use st_crs() from **sf** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(mpsz)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n:::\n:::\n\n\nThe **mpsz** data set is not in our desired coordinate system (SVY21; EPSG: 3414). Hence, we need to reproject it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(eldercare_services)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n```\n:::\n:::\n\n\nThe **eldercare_services** data set does not have the correct EPSG code (3414). Hence, we must reassign the EPSG code to it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(gardens)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(chas_sg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(other_amenities)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n:::\n:::\n\n\nThe **garden**, **chas_sg** and **other_amenities** data sets are also not in our desired coordinate system (SVY21; EPSG: 3414). Hence, we need to reproject them too.\n\nTo reproject data sets from one CRS to another CRS, we apply st_transform() from **sf** package as shown in the following three code chunks.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg <- st_transform(mpsz, 3414)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden <- st_transform(gardens, 3414)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchas <- st_transform(chas_sg, 3414)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nothers <- st_transform(other_amenities, 3414)\n```\n:::\n\n\nFor **eldercare_services**, we should assign the correct EPSG code using st_set_crs() from **sf** package instead.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare <- st_set_crs(eldercare_services, 3414)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 2.3.6 Extraction of relevant columns\n\n#### 2.3.6.1 Extraction of subzone and planning area names in mpsz_sf\n\nCurrently, our **mpsz_sg** data is pretty messy. The subzone and planning area names are hidden in the Description field. To extract them, we should follow the codes below.\n\nFor subzone:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg <- mpszsg %>%  \n  rowwise() %>%\n  mutate(SUBZONE= str_extract(`Description`, \"<th>SUBZONE_N</th> <td>(.*?)</td>\")) %>% ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg$SUBZONE <- str_remove_all(mpszsg$SUBZONE, \"<.*?>|SUBZONE_N\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg$SUBZONE <- str_remove(mpszsg$SUBZONE, \"^\\\\s+\")\n```\n:::\n\n\nFor planning area:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg <- mpszsg %>%  \n  rowwise() %>%\n  mutate(PLAN_AREA= str_extract(`Description`, \"<th>PLN_AREA_N</th> <td>(.*?)</td>\")) %>% ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg$PLAN_AREA <- str_remove_all(mpszsg$PLAN_AREA, \"<.*?>|PLN_AREA_N\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg$PLAN_AREA <- str_remove(mpszsg$PLAN_AREA, \"^\\\\s+\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(mpszsg, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 10 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 24431.8 ymin: 28515.07 xmax: 31146.33 ymax: 30069.41\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 10 × 5\n   Name   Description                                 geometry SUBZONE PLAN_AREA\n   <chr>  <chr>                             <MULTIPOLYGON [m]> <chr>   <chr>    \n 1 kml_1  \"<center><table><tr><th c… (((25910.34 29425.34, 26… DEPOT … BUKIT ME…\n 2 kml_2  \"<center><table><tr><th c… (((26750.09 29216.1, 267… BUKIT … BUKIT ME…\n 3 kml_3  \"<center><table><tr><th c… (((29161.2 29723.07, 291… CHINAT… OUTRAM   \n 4 kml_4  \"<center><table><tr><th c… (((29814.11 29616.89, 29… PHILLIP DOWNTOWN…\n 5 kml_5  \"<center><table><tr><th c… (((30137.77 29843.19, 30… RAFFLE… DOWNTOWN…\n 6 kml_6  \"<center><table><tr><th c… (((29699.44 29417.6, 296… CHINA … OUTRAM   \n 7 kml_7  \"<center><table><tr><th c… (((27748.04 29953.49, 27… TIONG … BUKIT ME…\n 8 kml_8  \"<center><table><tr><th c… (((30844.87 29021.96, 30… BAYFRO… DOWNTOWN…\n 9 kml_9  \"<center><table><tr><th c… (((27444.04 29961.41, 27… TIONG … BUKIT ME…\n10 kml_10 \"<center><table><tr><th c… (((30436.73 29517.49, 30… CLIFFO… DOWNTOWN…\n```\n:::\n:::\n\n\n#### 2.3.6.2 Extraction of CHAS clinic names in chas\n\nSimilarly, the **chas** data set has the clinic names hidden in the Description field. We apply the same steps as shown below to extract the clinic names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas <- chas %>%  \n  rowwise() %>%\n  mutate(NAME= str_extract(`Description`, \"<th>HCI_NAME</th> <td>(.*?)</td>\")) %>% ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchas$NAME <- str_remove_all(chas$NAME, \"<.*?>|HCI_NAME|\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchas$NAME <- str_remove_all(chas$NAME, \"^\\\\s+\")\n```\n:::\n\n\n#### 2.3.6.2 Extracting columns\n\nTo simplify our analysis and speed up our computation, we should only retain relevant fields in our data sets. Hence, we use select() from **dplyr** package to select the fields that we want to keep.\n\n**mpsz**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpszsg <- mpszsg %>% select(3:5)\n```\n:::\n\n\n**eldercare**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare <- eldercare %>% select(11,19)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 133 features and 1 field\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                                                           NAME\n1                                  Yuhua Senior Activity Centre\n2                                          THK SAC @ Kaki Bukit\n3                                            THK SAC @ Boon Lay\n4                        PEACE-Connect Senior Activity Centre@5\n5                                        THK SAC @ Beo Crescent\n6                                      Silver ACE @ Bukit Merah\n7  Lions Befrienders Senior Activity Centre @ Tampines Blk 499C\n8                    Care Corner Senior Activity Centre (WL569)\n9           Fei Yue Senior Activity Centre (Bukit Batok Branch)\n10       COMNET Senior Activity Centre @ 182 Rivervale Crescent\n                    geometry\n1  POINT (16614.08 36639.12)\n2  POINT (38803.81 35098.78)\n3  POINT (14481.92 36357.61)\n4  POINT (31505.35 31853.52)\n5  POINT (27218.35 30135.49)\n6  POINT (27278.94 29350.17)\n7  POINT (41665.14 37956.92)\n8  POINT (23147.94 45761.17)\n9  POINT (18820.58 36396.32)\n10  POINT (36446.37 41376.9)\n```\n:::\n:::\n\n\n**chas**:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas <- chas %>% select(3,4)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchas\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 645 features and 1 field\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 11234.32 ymin: 27388.9 xmax: 45333 ymax: 48380.51\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 645 × 2\n              geometry NAME                                         \n           <POINT [m]> <chr>                                        \n 1 (32176.99 37348.35) Affinity Medical Clinic                      \n 2 (39037.12 34234.33) BEDOK  CENTRAL CLINIC                        \n 3  (39378.86 33601.1) BEDOK CLINIC & SURGERY(Family Medical Centre)\n 4  (22295.64 46626.1) ACUMED MEDICAL GROUP                         \n 5 (27353.89 30162.99) Beo Crescent Clinic & Surgery                \n 6 (33064.94 35041.76) G.I.F.T MEDICAL CENTRE                       \n 7 (34620.42 42646.27) DR JOYCE & PARTNERS FAMILY CLINIC            \n 8 (29101.85 33647.61) DR LIM LEAN HUAT & ASSOCIATES PTE LTD        \n 9 (28449.68 31527.59) DTAP @ Somerset                              \n10  (25843.11 47551.7) DUXTON MEDICAL CLINIC CANBERRA               \n# ℹ 635 more rows\n```\n:::\n:::\n\n\n### 2.3.7 Extraction of study area\n\n#### 2.3.7.1 Extracting Singapore main island boundaries from mpszsg data set\n\nLet's take a look at our **mpszsg** data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(mpszsg))\n```\n:::\n\n\n![](images/mpszsg.png)\n\nFrom the above, we can see that the data set contains geometries of the outer islands of Singapore. In our research, however, we do not need these data as we are focusing on the main island of Singapore.\n\nHence, to see which what kind of islands there are contained in the data set, we can take a look at what plan areas there are using unique().\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(mpszsg$PLAN_AREA)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"BUKIT MERAH\"             \"OUTRAM\"                 \n [3] \"DOWNTOWN CORE\"           \"MARINA SOUTH\"           \n [5] \"MARINA EAST\"             \"RIVER VALLEY\"           \n [7] \"SINGAPORE RIVER\"         \"WESTERN ISLANDS\"        \n [9] \"MUSEUM\"                  \"QUEENSTOWN\"             \n[11] \"MARINE PARADE\"           \"SOUTHERN ISLANDS\"       \n[13] \"STRAITS VIEW\"            \"ROCHOR\"                 \n[15] \"TANGLIN\"                 \"NEWTON\"                 \n[17] \"CLEMENTI\"                \"BEDOK\"                  \n[19] \"PIONEER\"                 \"JURONG EAST\"            \n[21] \"KALLANG\"                 \"ORCHARD\"                \n[23] \"GEYLANG\"                 \"TOA PAYOH\"              \n[25] \"BUKIT TIMAH\"             \"TUAS\"                   \n[27] \"JURONG WEST\"             \"ANG MO KIO\"             \n[29] \"SERANGOON\"               \"TENGAH\"                 \n[31] \"BOON LAY\"                \"NOVENA\"                 \n[33] \"TAMPINES\"                \"HOUGANG\"                \n[35] \"CHANGI BAY\"              \"PAYA LEBAR\"             \n[37] \"BUKIT BATOK\"             \"PASIR RIS\"              \n[39] \"BUKIT PANJANG\"           \"CHOA CHU KANG\"          \n[41] \"BISHAN\"                  \"YISHUN\"                 \n[43] \"PUNGGOL\"                 \"MANDAI\"                 \n[45] \"CHANGI\"                  \"SENGKANG\"               \n[47] \"SELETAR\"                 \"SUNGEI KADUT\"           \n[49] \"WOODLANDS\"               \"SEMBAWANG\"              \n[51] \"WESTERN WATER CATCHMENT\" \"CENTRAL WATER CATCHMENT\"\n[53] \"SIMPANG\"                 \"LIM CHU KANG\"           \n[55] \"NORTH-EASTERN ISLANDS\"  \n```\n:::\n:::\n\n\nFrom here, we can see that the outer islands are classified as \" NORTH-EASTERN ISLANDS\", \" WESTERN ISLANDS\", \" SOUTHERN ISLANDS\" under PLAN_AREA. All other plan areas are in or connected to the main island of Singapore.\n\nTo remove these islands from our data set, we can use filter() from the **dplyr** package and apply the following code chunk, removing records that contain the string \"ISLANDS\" in the PLAN_AREA column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf <- mpszsg %>% filter(!str_detect(PLAN_AREA, \"ISLANDS\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(mpsz_sf))\n```\n:::\n\n\n![](images/mpsz_sf.png)\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nThen, to get the boundaries of Singapore main island,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgboundary_sf <- mpsz_sf %>% st_union\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(sgboundary_sf))\n```\n:::\n\n\n![](images/sgboundary_sf.png)\n\n#### 2.2.7.2 Extracting Singapore data from chas data set\n\nFrom our understanding, **chas** data set contains one data point at one of Singapore's outer islands. Hence, we want to extract rows that contain only data within Singapore main island. To do so, we use the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas <- chas[unlist(st_contains(sgboundary_sf, chas)),]\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nLet's take a look at our extracted chas data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(chas))\n```\n:::\n\n\n![](images/chas.png)\n\n#### 2.2.7.2 Extracting Singapore data from others data set\n\nFrom our understanding, **others** data set contains the data of other neighbouring countries and islands outside of Singapore main island. Hence, we want to extract rows that contain only data within Singapore main island. To do so, we use the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\namenities <- others[unlist(st_contains(sgboundary_sf, others)),]\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nHere, we check whether we have achieved our desired result for **amenities**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(amenities))\n```\n:::\n\n\n![](images/amenities.png)\n\nWe've successfully extracted them!\n\n#### 2.3.7.3 Checking of geospatial data sets\n\nTo confirm that all records in our **eldercare** and **garden** data sets are within the boundaries of Singapore main island, we can apply the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare[!unlist(st_contains(sgboundary_sf, eldercare)),]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 1 field\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: SVY21 / Singapore TM\n[1] NAME     geometry\n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden[!unlist(st_contains(sgboundary_sf, garden)),]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 2 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: SVY21 / Singapore TM\n[1] Name        Description geometry   \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n\nIn the above codes, we are checking for **eldercare** and **garden** records that are not contained by **sgboundary_sf**.\n\nSince the results return 0 row for both data sets, we are certain these data sets are confined to within Singapore's main island.\n\n## 2.4 Extracting types of other amenities\n\nThe **amenities** data set consists of different types of amenities recorded in different rows. To extract each of them (hospital, community centres, parks), we apply the codes below.\n\nHospital:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhospital <- amenities %>% filter(fclass == \"hospital\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCommunity Centre:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncommunitycentre <- amenities %>% filter(fclass == \"community_centre\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nPark:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark <- amenities %>% filter(fclass == \"park\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 2.5 Inserting capacity columns into facilities data frames\n\nFor our accessibility analysis, we would need the capacity (supply) of each facility.\n\nFor **eldercare**, we use an estimated capacity of 100, implying that each eldercare centre can hold 100 elderly people at any point of time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare <- eldercare %>% mutate(capacity = 100)\n```\n:::\n\n\nCommunity gardens are not very big, occupying a small land space within estates. Hence, we use an estimated capacity of 15, implying that each community garden can hold 25 elderly people at any point of time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden <- garden %>% mutate(capacity = 25)\n```\n:::\n\n\nMost general practitioner clinics in Singapore are also small in scale. Hence, we assume that each of them can hold 15 elderly people each time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas <- chas %>% mutate(capacity=15)\n```\n:::\n\n\nHospitals in Singapore has varying capacity. Based on various articles, such as this, we estimate that each hospital can hold about [1000](https://www.skh.com.sg/news/announcements/sengkang-general-and-community-hospitals-open-their-doors-to-serve-the-northeast-community) elderly people at any point of time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhospital <- hospital %>% mutate(capacity=1000)\n```\n:::\n\n\nCommunity centres occupy a significant land area, holding many activities for the entire neighbourhood. Hence, we estimate that it can hold about 1000 elderly at any point in time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncommunitycentre <- communitycentre %>% mutate(capacity = 1000)\n```\n:::\n\n\nMost parks in Singapore are quite big and can hold approximately 500 elderly at any point in time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark <- park %>% mutate(capacity = 500)\n```\n:::\n\n\n# 3 Data Preparation (Aspatial Data)\n\nThe first step to dealing with our aspatial data is to import it into our R environment. To do so, we can use read_csv() from the **readr** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresidents <- read.csv(\"data/respopagesextod2023.csv\")\n```\n:::\n\n\nWe take a look at the residents data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(residents)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 100,928\nColumns: 7\n$ PA   <chr> \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo K…\n$ SZ   <chr> \"Ang Mo Kio Town Centre\", \"Ang Mo Kio Town Centre\", \"Ang Mo Kio T…\n$ AG   <chr> \"0_to_4\", \"0_to_4\", \"0_to_4\", \"0_to_4\", \"0_to_4\", \"0_to_4\", \"0_to…\n$ Sex  <chr> \"Males\", \"Males\", \"Males\", \"Males\", \"Males\", \"Males\", \"Males\", \"M…\n$ TOD  <chr> \"HDB 1- and 2-Room Flats\", \"HDB 3-Room Flats\", \"HDB 4-Room Flats\"…\n$ Pop  <int> 0, 0, 10, 30, 0, 40, 0, 0, 0, 0, 10, 20, 0, 20, 0, 0, 0, 10, 10, …\n$ Time <int> 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023,…\n```\n:::\n:::\n\n\nSince the data has an AG (age) field broken down into several age groups, let's take a look at how many unique age group classifications there are using the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(residents$AG)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"0_to_4\"      \"5_to_9\"      \"10_to_14\"    \"15_to_19\"    \"20_to_24\"   \n [6] \"25_to_29\"    \"30_to_34\"    \"35_to_39\"    \"40_to_44\"    \"45_to_49\"   \n[11] \"50_to_54\"    \"55_to_59\"    \"60_to_64\"    \"65_to_69\"    \"70_to_74\"   \n[16] \"75_to_79\"    \"80_to_84\"    \"85_to_89\"    \"90_and_Over\"\n```\n:::\n:::\n\n\nThen, to extract only rows that contain residents aged 55 and above, and name this new data set as **elderly**, we can apply the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly <- residents %>% filter(AG %in% c(\"55_to_59\", \"60_to_64\", \"65_to_69\", \"70_to_74\", \"75_to_79\", \"80_to_84\", \"85_to_89\", \"90_and_Over\"))\n```\n:::\n\n\nNext, to summarize the number of population size of elderly according to Planning Area and Subzone, we can apply the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly <- elderly %>% group_by(PA, SZ) %>% summarise(sum(Pop))\n```\n:::\n\n\nThen, we rename the population size column \"sum(Pop)\" as 'demand'. This represents the demand for elderly-related services in each planning area and subzone.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly <- elderly %>% rename(demand = `sum(Pop)`)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 332 × 3\n# Groups:   PA [55]\n   PA         SZ                     demand\n   <chr>      <chr>                   <int>\n 1 Ang Mo Kio Ang Mo Kio Town Centre   1520\n 2 Ang Mo Kio Cheng San               10710\n 3 Ang Mo Kio Chong Boon              11100\n 4 Ang Mo Kio Kebun Bahru              9080\n 5 Ang Mo Kio Sembawang Hills          2450\n 6 Ang Mo Kio Shangri-La               7020\n 7 Ang Mo Kio Tagore                   3070\n 8 Ang Mo Kio Townsville               8370\n 9 Ang Mo Kio Yio Chu Kang                0\n10 Ang Mo Kio Yio Chu Kang East        1490\n# ℹ 322 more rows\n```\n:::\n:::\n\n\n# 4 Joining geospatial and aspatial data\n\nIt's time to combine the geospatial and aspatial data, using subzone and planning area names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 326 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 21448.47 xmax: 55941.94 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 326 × 3\n                                                      geometry SUBZONE PLAN_AREA\n *                                          <MULTIPOLYGON [m]> <chr>   <chr>    \n 1 (((25910.34 29425.34, 26265.82 29209.49, 26238.95 29165.57… DEPOT … BUKIT ME…\n 2 (((26750.09 29216.1, 26751.91 29173.68, 26762.63 29174.04,… BUKIT … BUKIT ME…\n 3 (((29161.2 29723.07, 29189.03 29704.77, 29209.22 29691.86,… CHINAT… OUTRAM   \n 4 (((29814.11 29616.89, 29806.68 29593.55, 29786.43 29615.23… PHILLIP DOWNTOWN…\n 5 (((30137.77 29843.19, 30138.42 29841.86, 30160.07 29797.29… RAFFLE… DOWNTOWN…\n 6 (((29699.44 29417.6, 29692.13 29405.75, 29690.85 29406.46,… CHINA … OUTRAM   \n 7 (((27748.04 29953.49, 27826.68 29943.78, 27840.27 29944.76… TIONG … BUKIT ME…\n 8 (((30844.87 29021.96, 30794.28 28944.99, 30649.08 29034.1,… BAYFRO… DOWNTOWN…\n 9 (((27444.04 29961.41, 27446.8 29808.05, 27566.69 29810.9, … TIONG … BUKIT ME…\n10 (((30436.73 29517.49, 30304.36 29415.54, 30214.96 29420.38… CLIFFO… DOWNTOWN…\n# ℹ 316 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 332 × 3\n# Groups:   PA [55]\n   PA         SZ                     demand\n   <chr>      <chr>                   <int>\n 1 Ang Mo Kio Ang Mo Kio Town Centre   1520\n 2 Ang Mo Kio Cheng San               10710\n 3 Ang Mo Kio Chong Boon              11100\n 4 Ang Mo Kio Kebun Bahru              9080\n 5 Ang Mo Kio Sembawang Hills          2450\n 6 Ang Mo Kio Shangri-La               7020\n 7 Ang Mo Kio Tagore                   3070\n 8 Ang Mo Kio Townsville               8370\n 9 Ang Mo Kio Yio Chu Kang                0\n10 Ang Mo Kio Yio Chu Kang East        1490\n# ℹ 322 more rows\n```\n:::\n:::\n\n\nFrom the above, we see that the subzone and planning area values in **elderly** data set are not in full uppercase, while that in **mpsz_sf** data set is in full uppercase. Since R is case sensitive, this would hinder our join.\n\nHence, we can change the values in **elderly** data set to full uppercase, so that it can match with the values in **mpsz_sf**. To do so, we can use toupper() as shown below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly$PA <- toupper(elderly$PA)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nelderly$SZ <- toupper(elderly$SZ)\n```\n:::\n\n\nNow that we have changed the values to uppercase, we can use left_join() from **dplyr** package to conduct our join, using subzone and planning area values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_demand <- left_join(mpsz_sf, elderly, by = c('SUBZONE' = 'SZ', 'PLAN_AREA' = 'PA'))\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_demand\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 326 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 21448.47 xmax: 55941.94 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 326 × 4\n                                               geometry SUBZONE PLAN_AREA demand\n                                     <MULTIPOLYGON [m]> <chr>   <chr>      <int>\n 1 (((25910.34 29425.34, 26265.82 29209.49, 26238.95 2… DEPOT … BUKIT ME…   1870\n 2 (((26750.09 29216.1, 26751.91 29173.68, 26762.63 29… BUKIT … BUKIT ME…    460\n 3 (((29161.2 29723.07, 29189.03 29704.77, 29209.22 29… CHINAT… OUTRAM      3590\n 4 (((29814.11 29616.89, 29806.68 29593.55, 29786.43 2… PHILLIP DOWNTOWN…      0\n 5 (((30137.77 29843.19, 30138.42 29841.86, 30160.07 2… RAFFLE… DOWNTOWN…      0\n 6 (((29699.44 29417.6, 29692.13 29405.75, 29690.85 29… CHINA … OUTRAM       680\n 7 (((27748.04 29953.49, 27826.68 29943.78, 27840.27 2… TIONG … BUKIT ME…   4090\n 8 (((30844.87 29021.96, 30794.28 28944.99, 30649.08 2… BAYFRO… DOWNTOWN…      0\n 9 (((27444.04 29961.41, 27446.8 29808.05, 27566.69 29… TIONG … BUKIT ME…   5140\n10 (((30436.73 29517.49, 30304.36 29415.54, 30214.96 2… CLIFFO… DOWNTOWN…      0\n# ℹ 316 more rows\n```\n:::\n:::\n\n\nWe've successfully combined our data! Now, we can easily map the demand of each region geometrically for analysis later.\n\n# 5 Creating hexagon data\n\nAccessibility analysis can be done with hexagon data as individual subzones might be too large. In this section, we will create hexagon data.\n\n## 5.1 Making a hexagon object\n\nTo make a hexagon object, we use st_make_grid() from **sf** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagons <- st_make_grid(mpsz_sf, cellsize = 250, what = \"polygons\", square = FALSE)\n```\n:::\n\n\nIn the above code, we set\n\n-   cellsize = 250, such that distance between opposite edges is 250m\n\n-   what = \"polygons\" to create polygons\n\n-   square = FALSE to create hexagonal grid instead of square grid\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(hexagons))\n```\n:::\n\n\n![](images/hexagons.png)\n\n## 5.2 Deriving hexagon of Singapore main island\n\nTo get the hexagon of Singapore main island,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagon <- hexagons %>% st_intersection(mpsz_sf)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(hexagon))\n```\n:::\n\n\n![](images/hexagon.png)\n\n## 5.3 Inserting attributes into hexagon\n\n**Step 1: Converting hexagon into sf object**\n\nWe can use glimpse() to gain an understanding of the structure of hexagon.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(hexagon)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nsfc_GEOMETRY of length 17370; first list element: List of 1\n $ : num [1:7, 1:2] 24535 24534 24533 24514 24506 ...\n - attr(*, \"class\")= chr [1:3] \"XY\" \"POLYGON\" \"sfg\"\n```\n:::\n:::\n\n\nAlternatively, we can use class() to determine the object class of hexagon.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(hexagon)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"sfc_GEOMETRY\" \"sfc\"         \n```\n:::\n:::\n\n\nFrom the results, we see that hexagon is in sfc class. To convert it into an sf object for easier manipulation, we can use st_sf() from **sf** as shown in the following code, and name the new sf object as **hexagon_sf**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagon_sf <- hexagon %>% st_sf()\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(hexagon_sf,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 10 features and 0 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 24431.8 ymin: 29242.98 xmax: 25292.54 ymax: 29615.08\nProjected CRS: SVY21 / Singapore TM\n                         geometry\n1  POLYGON ((24535.05 29319.2,...\n2  POLYGON ((24542.54 29603.55...\n3  POLYGON ((24500.44 29339.18...\n4  POLYGON ((24667.54 29387.04...\n5  POLYGON ((24542.54 29603.55...\n6  POLYGON ((24667.54 29387.04...\n7  POLYGON ((24917.54 29387.04...\n8  POLYGON ((24812.04 29592.29...\n9  POLYGON ((24917.54 29387.04...\n10 POLYGON ((25167.54 29387.04...\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n**Step 2: Inserting planning area and subzone names**\n\nHere, we use st_join() and st_overlaps() from **sf** package to combine the aggregated demand for each subzone into the **hexagon_sf** data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex <- st_join(hexagon_sf, mpsz_demand, st_overlaps)\n```\n:::\n\n\nst_overlaps() allows us to join **mpsz_demand** to **hexagon_sf** as long as there is an area of overlap, including cases where geometries share boundaries or overlap partially.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nSince many hexagons can make up a single subzone, and the current demand field in the hexagon_demand represents the demand for one entire subzone, we have to divide the aggregated demand across the different hexagons in each subzone.\n\nTo do so, we first find out the count of hexagons contained in each subzone by using the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_count <- st_drop_geometry(hex) %>% count(SUBZONE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nThen, we use left_join() from **dplyr** to include the total number of hexagons sharing the same subzone as the hexagon of that row.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_demand_sf <- left_join(hex, hex_count)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_demand_sf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 24023 features and 4 fields\nGeometry type: GEOMETRY\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 21448.47 xmax: 55941.94 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n               SUBZONE   PLAN_AREA demand  n                       geometry\n1           DEPOT ROAD BUKIT MERAH   1870 34 POLYGON ((24535.05 29319.2,...\n2           KENT RIDGE  QUEENSTOWN      0 56 POLYGON ((24535.05 29319.2,...\n3           DEPOT ROAD BUKIT MERAH   1870 34 POLYGON ((24542.54 29603.55...\n4           KENT RIDGE  QUEENSTOWN      0 56 POLYGON ((24542.54 29603.55...\n5           DEPOT ROAD BUKIT MERAH   1870 34 POLYGON ((24500.44 29339.18...\n6           KENT RIDGE  QUEENSTOWN      0 56 POLYGON ((24500.44 29339.18...\n7           DEPOT ROAD BUKIT MERAH   1870 34 POLYGON ((24667.54 29387.04...\n8  TELOK BLANGAH DRIVE BUKIT MERAH   6500 44 POLYGON ((24667.54 29387.04...\n9           DEPOT ROAD BUKIT MERAH   1870 34 POLYGON ((24542.54 29603.55...\n10      ALEXANDRA HILL BUKIT MERAH   5790 38 POLYGON ((24542.54 29603.55...\n```\n:::\n:::\n\n\nNext, we divide the aggregated demand by the number of hexagons sharing the same subzone. The new field, hexagon_demand, indicates the average demand of the particular hexagon.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_sf <- hex_demand_sf %>% mutate(hexagon_demand = ceiling(demand/n))\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n# 6 Preparing Distance Matrix\n\nWe need the distance matrix between the residential areas (reflected in **mpsz_demand**) and each facility to determine the accessibility to the latter.\n\nTo do so, we have to apply the steps in the following sections.\n\n### 6.1.1 Convert from sf data.table to SpatialPolygonsDataFrame\n\nWe can use data in sf format to prepare distance matrix. However, there has been empirical evidence that it is too computationally intensive, and that sp format is a better choice computationally. Hence, we convert our sf data sets into sp objects.\n\n#### 6.1.1.1 hex_sf\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_sp <- as(hex_sf, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatialPolygonsDataFrame \nfeatures    : 24023 \nextent      : 2667.538, 55941.94, 21448.47, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 5\nnames       :   SUBZONE,  PLAN_AREA, demand,     n, hexagon_demand \nmin values  : ADMIRALTY, ANG MO KIO,      0,     9,              0 \nmax values  :    YUNNAN,     YISHUN,  45870, 10336,            638 \n```\n:::\n:::\n\n\n#### 6.1.1.2 Eldercare Centres\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_sp <- as(eldercare, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatialPointsDataFrame \nfeatures    : 133 \nextent      : 14481.92, 41665.14, 28218.43, 46804.9  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 2\nnames       :                                 NAME, capacity \nmin values  : Abdullah Shooker Jewish Welfare Home,      100 \nmax values  :               Zion Home For The Aged,      100 \n```\n:::\n:::\n\n\n#### 6.1.1.3 Community gardens\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_sp <- as(garden, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n#### 6.1.1.4 CHAS clinics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas_sp <- as(chas, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n#### 6.1.1.5 Hospitals\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhospital_sp <- as(hospital, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n#### 6.1.1.5 Community Centres\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncommunitycentre_sp <- as(communitycentre, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n#### 6.1.1.6 Parks\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark_sp <- as(park, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 6.1.2 Computing distance matrix\n\nNext, we use spDists from sp to compute the distance matrix from each hexagon in hex_sp to each location in every facility data set, as shown below.\n\n#### 6.1.2.1 Hexagons and eldercare centres\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_dist_matrix <- spDists(hex_sp, eldercare_sp, longlat = FALSE)\n```\n:::\n\n\nWe put the longlat argument as FALSE as our data set geometries are not in longlat format.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nTo have an understanding of how the distance looks like, we can apply the following code to see the first 10 rows and columns of **eldercare_dist_matrix.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(eldercare_dist_matrix, n = c(5,5))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         [,1]     [,2]     [,3]     [,4]     [,5]\n[1,] 10768.59 15410.50 12254.27 7432.783 2821.313\n[2,] 10768.59 15410.50 12254.27 7432.783 2821.313\n[3,] 10566.90 15343.01 12077.96 7377.224 2788.049\n[4,] 10566.90 15343.01 12077.96 7377.224 2788.049\n[5,] 10702.29 15323.17 12205.93 7350.292 2747.318\n```\n:::\n:::\n\n\nThen, we repeat the same steps for all other facilities in section 3.1.2.2 to 3.1.3.4.\n\n#### 6.1.2.2 Community gardens\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_dist_matrix <- spDists(hex_sp, garden_sp, longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n#### 6.1.2.3 CHAS clinics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas_dist_matrix <- spDists(hex_sp, chas_sp, longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n#### 6.1.2.4 Other amenities (Hospitals, Community Centres, Parks)\n\nHospitals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhospital_dist_matrix <- spDists(hex_sp, hospital_sp, longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nCommunity Centres:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncommunitycentre_dist_matrix <- spDists(hex_sp, communitycentre_sp, longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nParks:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark_dist_matrix <- spDists(hex_sp, park_sp, longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 6.1.3 Labelling column and row headers of distance matrix\n\nRight now, our matrices do not have column and row headers, which can make it difficult to trace the hexagons and facilities when we look at them.\n\nHence, we use the codes below to extract the names of each data set.\n\n\n::: {.cell}\n\n:::\n\n\nThen, we insert the names into the matrices accordingly.\n\n\n::: {.cell}\n\n:::\n\n\n### 6.1.6 Distance matrix in kilometres\n\nSince our distance matrix values are currently in metres (as we used the SVY21 CRS), the unit system is a bit too small. We can convert their units to to kilometres using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_distmat_km <- as.matrix(eldercare_dist_matrix/1000)\ngarden_distmat_km <- as.matrix(garden_dist_matrix/1000)\nchas_distmat_km <- as.matrix(chas_dist_matrix/1000)\nhospital_distmat_km <- as.matrix(hospital_dist_matrix/1000)\ncommunitycentre_distmat_km <- as.matrix(communitycentre_dist_matrix/1000)\npark_distmat_km <- as.matrix(park_dist_matrix/1000)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nLet's take a look at the first 3 rows and columns of the **eldercare_distmat_km** matrix to have a rough idea of how it looks like.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(eldercare_distmat_km, 3, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Yuhua Senior Activity Centre THK SAC @ Kaki Bukit THK SAC @ Boon Lay\nDEPOT ROAD                     10.76859             15.41050           12.25427\nKENT RIDGE                     10.76859             15.41050           12.25427\nDEPOT ROAD                     10.56690             15.34301           12.07796\n           PEACE-Connect Senior Activity Centre@5 THK SAC @ Beo Crescent\nDEPOT ROAD                               7.432783               2.821313\nKENT RIDGE                               7.432783               2.821313\nDEPOT ROAD                               7.377224               2.788049\n           Silver ACE @ Bukit Merah\nDEPOT ROAD                 2.762694\nKENT RIDGE                 2.762694\nDEPOT ROAD                 2.804518\n           Lions Befrienders Senior Activity Centre @ Tampines Blk 499C\nDEPOT ROAD                                                     19.19933\nKENT RIDGE                                                     19.19933\nDEPOT ROAD                                                     19.11042\n           Care Corner Senior Activity Centre (WL569)\nDEPOT ROAD                                   16.49441\nKENT RIDGE                                   16.49441\nDEPOT ROAD                                   16.22810\n           Fei Yue Senior Activity Centre (Bukit Batok Branch)\nDEPOT ROAD                                            9.081028\nKENT RIDGE                                            9.081028\nDEPOT ROAD                                            8.856112\n           COMNET Senior Activity Centre @ 182 Rivervale Crescent\nDEPOT ROAD                                               16.95896\nKENT RIDGE                                               16.95896\nDEPOT ROAD                                               16.79460\n           Abdullah Shooker Jewish Welfare Home Adventist Home For The Elders\nDEPOT ROAD                             5.557858                      8.258787\nKENT RIDGE                             5.557858                      8.258787\nDEPOT ROAD                             5.479791                      8.113761\n           AWWA Community Home for Senior Citizens Bo Tien Home For The Aged\nDEPOT ROAD                                10.92968                  10.76771\nKENT RIDGE                                10.92968                  10.76771\nDEPOT ROAD                                10.70610                  10.60702\n           Evergreen Place, Home @Hong San Geylang East Home For The Aged\nDEPOT ROAD                        12.39381                       10.29883\nKENT RIDGE                        12.39381                       10.29883\nDEPOT ROAD                        12.15017                       10.21758\n           Henderson Senior Citizens' Home Kheng Chiu Loke Tin Kee Home\nDEPOT ROAD                        2.221623                     18.10114\nKENT RIDGE                        2.221623                     18.10114\nDEPOT ROAD                        2.231153                     18.01019\n           PERTAPIS Senior Citizens Fellowship Home SBWS Happy Villa (Females)\nDEPOT ROAD                                 8.978544                   4.540208\nKENT RIDGE                                 8.978544                   4.540208\nDEPOT ROAD                                 8.805637                   4.616720\n           Singapore Baptist Convention Golden Age Home\nDEPOT ROAD                                     8.543230\nKENT RIDGE                                     8.543230\nDEPOT ROAD                                     8.441053\n           St Andrew's Cathedral Home For The Aged St John's Home for the Aged\nDEPOT ROAD                                5.553162                    9.799429\nKENT RIDGE                                5.553162                    9.799429\nDEPOT ROAD                                5.335628                    9.674079\n           Jia Ying Senior Activity Centre @ 25 (Branch)\nDEPOT ROAD                                      13.66174\nKENT RIDGE                                      13.66174\nDEPOT ROAD                                      13.50605\n           Kembangan- Chai Chee Senior Activity Centre King George000e+000\nDEPOT ROAD                                    14.18357            7.208691\nKENT RIDGE                                    14.18357            7.208691\nDEPOT ROAD                                    14.12557            7.135687\n           Kreta Ayer Senior Activity Centre (Banda)\nDEPOT ROAD                                  4.606908\nKENT RIDGE                                  4.606908\nDEPOT ROAD                                  4.648112\n           Kreta Ayer Senior Activity Centre (Jalan Kukoh)\nDEPOT ROAD                                        4.212242\nKENT RIDGE                                        4.212242\nDEPOT ROAD                                        4.211064\n           Kreta Ayer Senior Activity Centre (Chin Swee)\nDEPOT ROAD                                      4.501230\nKENT RIDGE                                      4.501230\nDEPOT ROAD                                      4.502026\n           Lions Befrienders (Ang Mo Kio 318) Senior Activity Centre\nDEPOT ROAD                                                   10.5950\nKENT RIDGE                                                   10.5950\nDEPOT ROAD                                                   10.3792\n           Lions Befrienders (Bendemeer) Senior Activity Centre\nDEPOT ROAD                                             8.038227\nKENT RIDGE                                             8.038227\nDEPOT ROAD                                             7.929364\n           Lions Befrienders (Clementi) Senior Activity Centre\nDEPOT ROAD                                            4.857203\nKENT RIDGE                                            4.857203\nDEPOT ROAD                                            4.665798\n           Lions Befrienders (Ghim Moh) Senior Activity Centre\nDEPOT ROAD                                            3.580812\nKENT RIDGE                                            3.580812\nDEPOT ROAD                                            3.333016\n           Lions Befrienders (Mei Ling) Senior Activity Centre\nDEPOT ROAD                                            1.497476\nKENT RIDGE                                            1.497476\nDEPOT ROAD                                            1.240629\n           Lions Befrienders (Tampines) Senior Activity Centre\nDEPOT ROAD                                            18.73861\nKENT RIDGE                                            18.73861\nDEPOT ROAD                                            18.64712\n           Moral Senior Activity Centre (Kaki Bukit)\nDEPOT ROAD                                  14.64563\nKENT RIDGE                                  14.64563\nDEPOT ROAD                                  14.57943\n           PEACE-Connect Senior Activity Centre@8 Sarah Senior Activity Centre\nDEPOT ROAD                               7.357080                     2.552328\nKENT RIDGE                               7.357080                     2.552328\nDEPOT ROAD                               7.299589                     2.607032\n           Redhill Moral Senior Activity Centre Silver Ace @ Taman Jurong\nDEPOT ROAD                             1.916804                  10.60729\nKENT RIDGE                             1.916804                  10.60729\nDEPOT ROAD                             1.905709                  10.43367\n           Silver Ace@Lengkok Bahru Silver Ace@Redhill Silver Ace@Telok Blangah\nDEPOT ROAD                 1.542361           1.838115                 2.582780\nKENT RIDGE                 1.542361           1.838115                 2.582780\nDEPOT ROAD                 1.463295           1.793539                 2.734087\n           Silver Ace@Whampoa Sunlove Senior Activity Centre (Chai Chee)\nDEPOT ROAD           8.105683                                   14.46693\nKENT RIDGE           8.105683                                   14.46693\nDEPOT ROAD           7.971885                                   14.41294\n           St Vincent Home Zion Home For The Aged\nDEPOT ROAD        5.904919               14.91031\nKENT RIDGE        5.904919               14.91031\nDEPOT ROAD        5.855943               14.85324\n           NTUC Health Cluster Support @ Taman Jurong\nDEPOT ROAD                                   10.89856\nKENT RIDGE                                   10.89856\nDEPOT ROAD                                   10.72806\n           NTUC Health Cluster Support @ Bt Merah THK Cluster Support @ Bedok\nDEPOT ROAD                               2.320317                    15.59958\nKENT RIDGE                               2.320317                    15.59958\nDEPOT ROAD                               2.346807                    15.55936\n           Peace-Connect Cluster Operator THK Cluster Support @ Pipit\nDEPOT ROAD                       7.432783                    10.61185\nKENT RIDGE                       7.432783                    10.61185\nDEPOT ROAD                       7.377224                    10.52984\n           THK Cluster Support @ AMK AMKFSC Cluster Support\nDEPOT ROAD                  11.56523               11.01284\nKENT RIDGE                  11.56523               11.01284\nDEPOT ROAD                  11.33507               10.81115\n           Carecorner Cluster Suppport SACS Cluster Support@Jurong East\nDEPOT ROAD                    8.136583                         10.79587\nKENT RIDGE                    8.136583                         10.79587\nDEPOT ROAD                    7.965075                         10.58972\n           THK Senior Group Home @ AMK257 THK Senior Group Home @ Indus\nDEPOT ROAD                       10.50357                      3.152904\nKENT RIDGE                       10.50357                      3.152904\nDEPOT ROAD                       10.26863                      3.104613\n           PEACE-Connect Senior Group Home@8\nDEPOT ROAD                          7.357080\nKENT RIDGE                          7.357080\nDEPOT ROAD                          7.299589\n           TOUCH Senior Group Home@Geylang Bahru\nDEPOT ROAD                              8.741077\nKENT RIDGE                              8.741077\nDEPOT ROAD                              8.635039\n           Lions Befrienders Senior Group Home (Mei Ling)\nDEPOT ROAD                                       1.453488\nKENT RIDGE                                       1.453488\nDEPOT ROAD                                       1.193367\n           Care Corner SGH @ WL569A SACS Senior Group Home @ 373 JE\nDEPOT ROAD                 16.49441                        10.79091\nKENT RIDGE                 16.49441                        10.79091\nDEPOT ROAD                 16.22810                        10.58532\n           Fei Yue Senior Group Home @ Hougang\nDEPOT ROAD                            12.24240\nKENT RIDGE                            12.24240\nDEPOT ROAD                            12.10808\n           COMNET Senior Group Home @ Rivervale Crescent\nDEPOT ROAD                                      16.95896\nKENT RIDGE                                      16.95896\nDEPOT ROAD                                      16.79460\n           Lions Befrienders Senior Group Home @ Tampines 499C\nDEPOT ROAD                                            19.19933\nKENT RIDGE                                            19.19933\nDEPOT ROAD                                            19.11042\n           Fei Yue Senior Group Home @ Teck Whye Crescent\nDEPOT ROAD                                       12.43091\nKENT RIDGE                                       12.43091\nDEPOT ROAD                                       12.17904\n           Care Corner SGH @ WL180C THK Senior Group Home @ Pipit Road\nDEPOT ROAD                 17.67461                           10.66932\nKENT RIDGE                 17.67461                           10.66932\nDEPOT ROAD                 17.40822                           10.58660\n           NTUC Health Senior Group Home @ Henderson\nDEPOT ROAD                                  2.221623\nKENT RIDGE                                  2.221623\nDEPOT ROAD                                  2.231153\n           Econ Health and Wellness Centre\nDEPOT ROAD                        9.126577\nKENT RIDGE                        9.126577\nDEPOT ROAD                        8.944136\n           Thye Hua Kwan Moral Charities Limited\nDEPOT ROAD                              10.83700\nKENT RIDGE                              10.83700\nDEPOT ROAD                              10.65974\n           Econ Health and Wellness Centre Econ Health and Wellness Centre\nDEPOT ROAD                        1.707285                        16.57802\nKENT RIDGE                        1.707285                        16.57802\nDEPOT ROAD                        1.521875                        16.31170\n           Econ Health and Wellness Centre\nDEPOT ROAD                        3.006035\nKENT RIDGE                        3.006035\nDEPOT ROAD                        2.965288\n           Thye Hua Kwan Moral Charities Limited\nDEPOT ROAD                              1.032054\nKENT RIDGE                              1.032054\nDEPOT ROAD                              1.279705\n           Pacific Activity Centres Pte Ltd Econ Health and Wellness Centre\nDEPOT ROAD                         17.27840                        14.00155\nKENT RIDGE                         17.27840                        14.00155\nDEPOT ROAD                         17.01261                        13.75145\n           Econ Health and Wellness Centre Econ Health and Wellness Centre\nDEPOT ROAD                        17.52692                        15.84899\nKENT RIDGE                        17.52692                        15.84899\nDEPOT ROAD                        17.45148                        15.65940\n           Pacific Activity Centres Pte Ltd Pacific Activity Centres Pte Ltd\nDEPOT ROAD                         17.46281                         17.48873\nKENT RIDGE                         17.46281                         17.48873\nDEPOT ROAD                         17.27481                         17.24186\n           Econ Health and Wellness Centre Pacific Activity Centres Pte Ltd\nDEPOT ROAD                        8.937104                         17.32614\nKENT RIDGE                        8.937104                         17.32614\nDEPOT ROAD                        8.703351                         17.08120\n           Pacific Activity Centres Pte Ltd Pacific Activity Centres Pte Ltd\nDEPOT ROAD                         17.14385                         16.77031\nKENT RIDGE                         17.14385                         16.77031\nDEPOT ROAD                         16.96089                         16.67008\n           NTUC Eldercare Co-operative Ltd Pacific Activity Centres Pte Ltd\nDEPOT ROAD                        17.62679                         15.31435\nKENT RIDGE                        17.62679                         15.31435\nDEPOT ROAD                        17.36043                         15.13741\n           Pacific Activity Centres Pte Ltd Adventist Home for the Elders\nDEPOT ROAD                         3.073342                      12.09625\nKENT RIDGE                         3.073342                      12.09625\nDEPOT ROAD                         3.069873                      11.91172\n           Adventist Home for the Elders Methodist Welfare Services\nDEPOT ROAD                      8.403204                   15.60002\nKENT RIDGE                      8.403204                   15.60002\nDEPOT ROAD                      8.256663                   15.40072\n           Presbyterian Community Services\nDEPOT ROAD                        7.101367\nKENT RIDGE                        7.101367\nDEPOT ROAD                        6.853605\n           Singapore Anglican Community Services\nDEPOT ROAD                              16.42016\nKENT RIDGE                              16.42016\nDEPOT ROAD                              16.17779\n           Singapore Anglican Community Services Unicare Services Pte Ltd\nDEPOT ROAD                              11.33441                 12.77876\nKENT RIDGE                              11.33441                 12.77876\nDEPOT ROAD                              11.13841                 12.54205\n           AWWA Senior Activity Centre\nDEPOT ROAD                    10.92968\nKENT RIDGE                    10.92968\nDEPOT ROAD                    10.70610\n           THK Bedok Radiance Senior Activity Centre\nDEPOT ROAD                                  15.63803\nKENT RIDGE                                  15.63803\nDEPOT ROAD                                  15.59665\n           Care Corner Senior Activity Centre (TP5)\nDEPOT ROAD                                 8.708024\nKENT RIDGE                                 8.708024\nDEPOT ROAD                                 8.540212\n           Care Corner Senior Activity Centre (TP149)\nDEPOT ROAD                                   7.419552\nKENT RIDGE                                   7.419552\nDEPOT ROAD                                   7.235688\n           Care Corner Senior Activity Centre (TP170)\nDEPOT ROAD                                   7.131283\nKENT RIDGE                                   7.131283\nDEPOT ROAD                                   6.949616\n           Care Corner Senior Activity Centre (TP62B)\nDEPOT ROAD                                   8.136583\nKENT RIDGE                                   8.136583\nDEPOT ROAD                                   7.965075\n           CARElderly Senior Activity Centre\nDEPOT ROAD                          10.73266\nKENT RIDGE                          10.73266\nDEPOT ROAD                          10.63323\n           CARElderly Senior Activity Centre (Merpati)\nDEPOT ROAD                                    10.49538\nKENT RIDGE                                    10.49538\nDEPOT ROAD                                    10.39713\n           COMNET @ Teck Ghee Senior Activity Centre\nDEPOT ROAD                                  10.84662\nKENT RIDGE                                  10.84662\nDEPOT ROAD                                  10.63928\n           Teck Ghee Senior Activity Centre Branch @ Blk 469\nDEPOT ROAD                                          11.01284\nKENT RIDGE                                          11.01284\nDEPOT ROAD                                          10.81115\n           Chong Hua Tong Senior Activity Centre\nDEPOT ROAD                              6.502252\nKENT RIDGE                              6.502252\nDEPOT ROAD                              6.382633\n           COMNET@Sin Ming Senior Activity Centre\nDEPOT ROAD                               9.270714\nKENT RIDGE                               9.270714\nDEPOT ROAD                               9.052102\n           Fei Yue Senior Activity Centre (Holland Close)\nDEPOT ROAD                                       3.124593\nKENT RIDGE                                       3.124593\nDEPOT ROAD                                       2.858799\n           Fei Yue SAC (Commonwealth Branch)\nDEPOT ROAD                          2.934184\nKENT RIDGE                          2.934184\nDEPOT ROAD                          2.667727\n           Fei Yue Senior Activity Centre (Teck Whye) Goodlife!\nDEPOT ROAD                                   12.13158  12.72238\nKENT RIDGE                                   12.13158  12.72238\nDEPOT ROAD                                   11.88021  12.70247\n           Harmony Activity Centre Henderson Senior Activity Centre\nDEPOT ROAD                10.28149                         2.221623\nKENT RIDGE                10.28149                         2.221623\nDEPOT ROAD                10.20134                         2.231153\n           Indus Moral CARE Jia Ying Senior Activity Centre\nDEPOT ROAD         3.152904                        13.51780\nKENT RIDGE         3.152904                        13.51780\nDEPOT ROAD         3.104613                        13.36491\n           Sunlove Senior Activity Centre (Marsiling)\nDEPOT ROAD                                   17.69458\nKENT RIDGE                                   17.69458\nDEPOT ROAD                                   17.42831\n           Tembusu Senior Activity Centre THK SAC @ AMK 257 THK SAC @ AMK 645\nDEPOT ROAD                       11.87656          10.50357          11.70562\nKENT RIDGE                       11.87656          10.50357          11.70562\nDEPOT ROAD                       11.81408          10.26863          11.47405\n           THK SAC @ Toa Payoh 15 THK SAC @ Bukit Merah\nDEPOT ROAD                8.74966              2.139170\nKENT RIDGE                8.74966              2.139170\nDEPOT ROAD                8.59333              2.151858\n           THK SAC @ Henderson (Satellite 93) THK SAC @ MacPherson\nDEPOT ROAD                           2.135025             10.48451\nKENT RIDGE                           2.135025             10.48451\nDEPOT ROAD                           2.107221             10.39914\n           THK SAC @ Telok Blangah Crescent THK SAC @ Toa Payoh 31\nDEPOT ROAD                          1.75364               8.178301\nKENT RIDGE                          1.75364               8.178301\nDEPOT ROAD                          1.84931               8.018690\n           THK SAC @ AMK 208 Thong Kheng Senior Activity Centre (Queenstown)\nDEPOT ROAD          10.33161                                       0.8368224\nKENT RIDGE          10.33161                                       0.8368224\nDEPOT ROAD          10.10879                                       0.6892143\n           Thong Kheng Senior Activity Centre (Tanglin-Cairnhill)\nDEPOT ROAD                                               2.376208\nKENT RIDGE                                               2.376208\nDEPOT ROAD                                               2.389873\n           TOUCH Senior Activity Centre Wesley Senior Activity Centre\nDEPOT ROAD                     8.741077                      6.827514\nKENT RIDGE                     8.741077                      6.827514\nDEPOT ROAD                     8.635039                      6.755446\n           Evergreen Circle SAC Fei Yue Senior Activity Centre (Bukit Batok)\nDEPOT ROAD             16.38093                                     9.696468\nKENT RIDGE             16.38093                                     9.696468\nDEPOT ROAD             16.28901                                     9.480600\n```\n:::\n:::\n\n\n# 7 Modelling and Visualizing Accesssibility using Hansen Method\n\nTo compute Hansen's accessibility, we use ac() of **SpatialAcc** package.\n\n## 7.1 Computing Hansen's accessibility\n\nHere, we compute the accessibility of eldercare centres (**eldercare**) from each hexagon, and convert it to a data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_acc_hansen <- data.frame(ac(hex_sf$hexagon_demand,\n                                      eldercare$capacity,\n                                      eldercare_distmat_km,\n                                      power = 2,\n                                      family = \"Hansen\"))\n```\n:::\n\n\nThen, we rename the column name as it looks too messy (and confusing if we want to copy it later on).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(eldercare_acc_hansen) <- \"accHansen\"\n```\n:::\n\n\nThen, we convert the data into tibble format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_acc_hansen <- as_tibble(eldercare_acc_hansen)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nNext, we bind the columns of **hex_sf** and **eldercare_acc_hansen** so that we can find out the respective eldercare_acc_hansen values for each hexagon in **hex_sf** in a very clear manner, using bind_cols().\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(eldercare_hexagon_hansen, \"data/rds/eldercare_hexagon_hansen.rds\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nWe can do the same for the other 5 types of facilities, as shown in the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_acc_hansen <- data.frame(ac(hex_sf$hexagon_demand,\n                                      garden$capacity,\n                                      garden_distmat_km,\n                                      power = 2,\n                                      family = \"Hansen\"))\nchas_acc_hansen <- data.frame(ac(hex_sf$hexagon_demand,\n                                      chas$capacity,\n                                      chas_distmat_km,\n                                      power = 2,\n                                      family = \"Hansen\"))\nhospital_acc_hansen <- data.frame(ac(hex_sf$hexagon_demand,\n                                      hospital$capacity,\n                                      hospital_distmat_km,\n                                      power = 2,\n                                      family = \"Hansen\"))\ncommunitycentre_acc_hansen <- data.frame(ac(hex_sf$hexagon_demand,\n                                      communitycentre$capacity,\n                                      communitycentre_distmat_km,\n                                      power = 2,\n                                      family = \"Hansen\"))\npark_acc_hansen <- data.frame(ac(hex_sf$hexagon_demand,\n                                      park$capacity,\n                                      park_distmat_km,\n                                      power = 2,\n                                      family = \"Hansen\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(garden_acc_hansen) <- \"accHansen\"\ncolnames(chas_acc_hansen) <- \"accHansen\"\ncolnames(hospital_acc_hansen) <- \"accHansen\"\ncolnames(communitycentre_acc_hansen) <- \"accHansen\"\ncolnames(park_acc_hansen) <- \"accHansen\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_acc_hansen <- as_tibble(garden_acc_hansen)\nchas_acc_hansen <- as_tibble(chas_acc_hansen)\nhospital_acc_hansen <- as_tibble(hospital_acc_hansen)\ncommunitycentre_acc_hansen <- as_tibble(communitycentre_acc_hansen)\npark_acc_hansen <- as_tibble(park_acc_hansen)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 7.2 Visualizing Hansen's accessibility\n\n### 7.2.1 Extracting map extend\n\nWe need to map extend for our visualizations. To extract it, we use st_bbox() from sf package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapex <- st_bbox(hex_sf)\n```\n:::\n\n\n### 7.2.2 Visualization\n\nThen, we apply the appropriate tmap functions to create our visualization of the accessibility values. Here, I will only show selected facilities due to space constraints.\n\nEldercare centres:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(eldercare_hexagon_hansen,\n         bbox = mapex) + \n  tm_fill(col = \"accHansen\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: Hansen method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n:::\n\n\n![](images/ac%20eldercare%20hansen.png)\n\nCommunity gardens:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(garden_hexagon_hansen,\n         bbox = mapex) + \n  tm_fill(col = \"accHansen\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(garden) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to community gardens: Hansen method\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n:::\n\n\n![](images/ac%20garden%20hansen.png)\n\nOf course, we can adjust the options in tm_fill() however we like. n represents the number of classifications for our accessibility values, and style represents how they should be classified.\n\n## 7.3 Statistical graphic visualization\n\nA statistical graphic visualization might be very helpful to give a concise big picture of our data too.\n\nSince we want a simpler view, we can perhaps choose to depict our data by regions as it consists of less variables.\n\nTo derive the region name of each hexagon, we can use left_join() from **dplyr** as shown below, bringing region names in from mpsz, and joining both data sets using subzone names.\n\nEldercare:\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_hansen <- left_join(eldercare_hexagon_hansen, st_drop_geometry(mpsz), \n                          by = c(`SUBZONE` = 'SUBZONE_N')) %>% \n  select(1:6, 13)\n```\n:::\n\n\nIn the above, we also selected relevant columns only, to keep our output simple.\n\nThen, we use the relevant **ggplot2** functions to construct a boxplot of accessibility values by regions as shown below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=eldercare_hansen, \n       aes(y = log(accHansen), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n:::\n\n\n![](images/eldercare%20hansen%20stat%20plot.png)\n\nCommunity gardens:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_hansen <- left_join(garden_hexagon_hansen, st_drop_geometry(mpsz), \n                          by = c(`SUBZONE` = 'SUBZONE_N')) %>% \n  select(1:6, 13)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=garden_hansen, \n       aes(y = log(accHansen), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n:::\n\n\n![](images/garden%20hansen%20stat%20plot.png)\n\n# 8 Modelling and Visualizing Accesssibility using KD2SFCA Method\n\nSimilar to Hansen method, we would be using ac() from **SpatialAcc** package. We would also mostly apply the same steps throughout the analysis, with the only change being the family argument used in ac().\n\n## 8.1 Computing KD2SFCA's accessibility\n\nHowever, KD2SFCA method does not allow NA values. Hence, we replace the NA values with '0' as shown below before beginning our analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_sf$hexagon_demand[is.na(hex_sf$hexagon_demand)] <- 0\n```\n:::\n\n\nThereafter, we apply similar analysis steps as that of Hansen method.\n\nEldercare centres:\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_acc_KD2SFCA <- data.frame(ac(hex_sf$hexagon_demand,\n                                      eldercare$capacity,\n                                      eldercare_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"KD2SFCA\"))\ncolnames(eldercare_acc_KD2SFCA) <- \"accKD2SFCA\"\neldercare_acc_KD2SFCA <- as_tibble(eldercare_acc_KD2SFCA)\neldercare_hexagon_KD2SFCA <- bind_cols(hex_sf, eldercare_acc_KD2SFCA)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nCHAS clinics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas_acc_KD2SFCA <- data.frame(ac(hex_sf$hexagon_demand,\n                                      chas$capacity,\n                                      chas_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"KD2SFCA\"))\ncolnames(chas_acc_KD2SFCA) <- \"accKD2SFCA\"\nchas_acc_KD2SFCA <- as_tibble(chas_acc_KD2SFCA)\nchas_hexagon_KD2SFCA <- bind_cols(hex_sf, chas_acc_KD2SFCA)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nWe can do the same for the other types of facilities, as shown in the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_acc_KD2SFCA <- data.frame(ac(hex_sf$hexagon_demand,\n                                      garden$capacity,\n                                      garden_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"KD2SFCA\"))\ncolnames(garden_acc_KD2SFCA) <- \"accKD2SFCA\"\ngarden_acc_KD2SFCA <- as_tibble(garden_acc_KD2SFCA)\ngarden_hexagon_KD2SFCA <- bind_cols(hex_sf, garden_acc_KD2SFCA)\n\n\nhospital_acc_KD2SFCA <- data.frame(ac(hex_sf$hexagon_demand,\n                                      hospital$capacity,\n                                      hospital_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"KD2SFCA\"))\ncolnames(hospital_acc_KD2SFCA) <- \"accKD2SFCA\"\nhospital_acc_KD2SFCA <- as_tibble(hospital_acc_KD2SFCA)\nhospital_hexagon_KD2SFCA <- bind_cols(hex_sf, hospital_acc_KD2SFCA)\n\n\ncommunitycentre_acc_KD2SFCA <- data.frame(ac(hex_sf$hexagon_demand,\n                                       communitycentre$capacity,\n                                       communitycentre_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"KD2SFCA\"))\ncolnames(communitycentre_acc_KD2SFCA) <- \"accKD2SFCA\"\ncommunitycentre_acc_KD2SFCA <- as_tibble(communitycentre_acc_KD2SFCA)\ncommunitycentre_hexagon_KD2SFCA <- bind_cols(hex_sf, communitycentre_acc_KD2SFCA)\n\n\npark_acc_KD2SFCA <- data.frame(ac(hex_sf$hexagon_demand,\n                                      park$capacity,\n                                      park_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"KD2SFCA\"))\ncolnames(park_acc_KD2SFCA) <- \"accKD2SFCA\"\npark_acc_KD2SFCA <- as_tibble(park_acc_KD2SFCA)\npark_hexagon_KD2SFCA <- bind_cols(hex_sf, park_acc_KD2SFCA)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 8.2 Visualizing KD2SFCA's accessibility\n\nSimilar to Hansen method, we can also visualize the KD2SFCA accessibility methods as shown below.\n\nEldercare:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(eldercare_hexagon_KD2SFCA,\n         bbox = mapex) + \n  tm_fill(col = \"accKD2SFCA\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: KD2SFCA method\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n:::\n\n\n![](images/ac%20eldercare%20kd2sfca.png)\n\nCHAS clinics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(chas_hexagon_KD2SFCA,\n         bbox = mapex) + \n  tm_fill(col = \"accKD2SFCA\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(chas) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to CHAS clinics: KD2SFCA method\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n:::\n\n\n![](images/ac%20chas%20kd2sfca.png)\n\n## 8.3 Statistical graphic visualization\n\nWe can use statistical graphic visualizations here too.\n\nEldercare:\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_kd2sfca <- left_join(eldercare_hexagon_KD2SFCA, st_drop_geometry(mpsz), \n                          by = c(`SUBZONE` = 'SUBZONE_N')) %>% \n  select(1:6, 13)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=eldercare_kd2sfca, \n       aes(y = log(accKD2SFCA), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n:::\n\n\n![](images/eldercare%20kd2sfca%20stat%20plot.png)\n\nCHAS clinics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchas_kd2sfca <- left_join(chas_hexagon_KD2SFCA, st_drop_geometry(mpsz), \n                          by = c(`SUBZONE` = 'SUBZONE_N')) %>% \n  select(1:6, 13)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=chas_kd2sfca, \n       aes(y = log(accKD2SFCA), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n:::\n\n\n![](images/chas%20kd2sfca%20stat%20plot.png)\n\n# 9 Modelling and Visualizing Accessibility using SAM Method\n\nSimilar to Hansen and KD2SFCA methods, we run the same steps with the change being in the family argument used in ac().\n\n## 9.1 Computing SAM's accessibility\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_acc_SAM <- data.frame(ac(hex_sf$hexagon_demand,\n                                      eldercare$capacity,\n                                      eldercare_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"SAM\"))\ncolnames(eldercare_acc_SAM) <- \"accSAM\"\neldercare_acc_SAM <- as_tibble(eldercare_acc_SAM)\neldercare_hexagon_SAM <- bind_cols(hex_sf, eldercare_acc_SAM)\n```\n:::\n\n\nWe can do the same for the other types of facilities, as shown in the following code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarden_acc_SAM <- data.frame(ac(hex_sf$hexagon_demand,\n                                      garden$capacity,\n                                      garden_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"SAM\"))\ncolnames(garden_acc_SAM) <- \"accSAM\"\ngarden_acc_SAM <- as_tibble(garden_acc_SAM)\ngarden_hexagon_SAM <- bind_cols(hex_sf, garden_acc_SAM)\n\nchas_acc_SAM <- data.frame(ac(hex_sf$hexagon_demand,\n                                      chas$capacity,\n                                      chas_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"SAM\"))\ncolnames(chas_acc_SAM) <- \"accSAM\"\nchas_acc_SAM <- as_tibble(chas_acc_SAM)\nchas_hexagon_SAM <- bind_cols(hex_sf, chas_acc_SAM)\n\nhospital_acc_SAM <- data.frame(ac(hex_sf$hexagon_demand,\n                                      hospital$capacity,\n                                      hospital_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"SAM\"))\ncolnames(hospital_acc_SAM) <- \"accSAM\"\nhospital_acc_SAM <- as_tibble(hospital_acc_SAM)\nhospital_hexagon_SAM <- bind_cols(hex_sf, hospital_acc_SAM)\n\n\ncommunitycentre_acc_SAM<- data.frame(ac(hex_sf$hexagon_demand,\n                                       communitycentre$capacity,\n                                       communitycentre_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"SAM\"))\ncolnames(communitycentre_acc_SAM) <- \"accSAM\"\ncommunitycentre_acc_SAM <- as_tibble(communitycentre_acc_SAM)\ncommunitycentre_hexagon_SAM <- bind_cols(hex_sf, communitycentre_acc_SAM)\n\n\npark_acc_SAM <- data.frame(ac(hex_sf$hexagon_demand,\n                                      park$capacity,\n                                      park_distmat_km,\n                                      d0 = 50,\n                                      power = 2,\n                                      family = \"SAM\"))\ncolnames(park_acc_SAM) <- \"accSAM\"\npark_acc_SAM <- as_tibble(park_acc_SAM)\npark_hexagon_SAM <- bind_cols(hex_sf, park_acc_SAM)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 9.2 Visualizing SAM's accessibility\n\nEldercare:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(eldercare_hexagon_SAM,\n         bbox = mapex) + \n  tm_fill(col = \"accSAM\",\n          n = 5,\n          style = \"fisher\",\n          na.rm = TRUE,\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: SAM method\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n:::\n\n\n![](images/ac%20eldercare%20SAM.png)\n\nParks:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(park_hexagon_SAM,\n         bbox = mapex) + \n  tm_fill(col = \"accSAM\",\n          n = 5,\n          style = \"fisher\",\n          na.rm = TRUE,\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to parks: SAM method\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n:::\n\n\n![](images/ac%20park%20SAM.png)\n\n## 9.3 Statistical graphic visualization\n\nEldercare:\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_SAM <- left_join(eldercare_hexagon_SAM, st_drop_geometry(mpsz), \n                          by = c(`SUBZONE` = 'SUBZONE_N')) %>% \n  select(1:6, 13)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=eldercare_SAM, \n       aes(y = log(accSAM), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n:::\n\n\n![](images/eldercare%20sam%20stat%20plot.png)\n\nParks:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark_SAM <- left_join(park_hexagon_SAM, st_drop_geometry(mpsz), \n                          by = c(`SUBZONE` = 'SUBZONE_N')) %>% \n  select(1:6, 13)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=park_SAM, \n       aes(y = log(accSAM), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n:::\n\n\n![](images/park%20SAM%20stat%20plot.png)\n\nWe can run the same steps to visualize the statistical plots of other facilities.\n\nWe're done with the analyses!!!!! Hurray!!!\n\n# 10 Moving Forward: Project UI Design\n\nFrom this take-home exercise, I had a better understanding of how I can potentially integrate such analysis into our ShinyApp for users to gain insights. In our ShinyApp webpage, there would be 3 tabs for users to conduct different types of analysis based on our respective modules.\n\nIn the Accessibility Analysis tab, we would potentially implement the following options on the left pane for users to customize their type of accessibility analysis.\n\n+-------------------------------------+--------------------------------------------------------+\n| Type of Option                      | Option Values                                          |\n+=====================================+========================================================+\n| Accessibility Analysis Method       | -   Hansen                                             |\n|                                     |                                                        |\n|                                     | -   KD2SFCA                                            |\n|                                     |                                                        |\n|                                     | -   SAM                                                |\n+-------------------------------------+--------------------------------------------------------+\n| Facility                            | -   Eldercare centres                                  |\n|                                     |                                                        |\n|                                     | -   CHAS clinics                                       |\n|                                     |                                                        |\n|                                     | -   Community gardens                                  |\n|                                     |                                                        |\n|                                     | -   Hospitals                                          |\n|                                     |                                                        |\n|                                     | -   Parks                                              |\n|                                     |                                                        |\n|                                     | -   Community Centres                                  |\n+-------------------------------------+--------------------------------------------------------+\n| Accessibility analysis d0 value     | Values of d0 in intervals of 20 ranging from 20 to 200 |\n+-------------------------------------+--------------------------------------------------------+\n| Visualization Classification Method | List of various classification methods, for example:   |\n|                                     |                                                        |\n|                                     | -   quantile                                           |\n|                                     |                                                        |\n|                                     | -   pretty                                             |\n|                                     |                                                        |\n|                                     | -   fisher                                             |\n+-------------------------------------+--------------------------------------------------------+\n| Subzone 1                           | List of planning subzones, for example:                |\n|                                     |                                                        |\n|                                     | -   Ang Mo Kio Town Centre                             |\n|                                     |                                                        |\n|                                     | -   Tampines East                                      |\n+-------------------------------------+--------------------------------------------------------+\n| Subzone 2                           | List of planning subzones, for example:                |\n|                                     |                                                        |\n|                                     | -   Ang Mo Kio Town Centre                             |\n|                                     |                                                        |\n|                                     | -   Tampines East                                      |\n+-------------------------------------+--------------------------------------------------------+\n\nWe would most likely offer at most 5 options to prevent the UI from appearing too complicated and overwhelming for users.\n\nAdditionally, if possible, we would look into adding the option to include network analysis, on top of the existing Euclidean distance analysis.\n\nOn the right pane, the results of the analysis would be displayed.\n\nBelow is a sketch of how we expect the UI to look like. Nonetheless, we are still exploring and there might be changes made along the way.\n\n![](images/project%20ui.png)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}