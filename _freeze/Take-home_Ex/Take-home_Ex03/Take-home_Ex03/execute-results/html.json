{
  "hash": "95a724cf295ba10a9cc6b5f3186608d9",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 3: Prototyping Modules for Geospatial Analytics Shiny Application (not done)\"\nformat: \n  html: \n    code-fold: true\n    code-summary: \"Show the code\"\nexecute:\n  freeze: true\n  warning: false\neditor: visual\ndate: \"March 16, 2024\"\n---\n\n\n# 1 Overview\n\n## 1.1 Background\n\n## 1.2 Objectives\n\n## 1.3 The Task\n\n## 1.4 The Data\n\n## 1.5 Installing and Loading R Packages\n\nIn this exercise, the following R packages would be used:\n\nThen, to install and/or load the R packages, we can use p_load() from the pacman package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, tmap, SpatialAcc, ggplot2, ggstatsplot, spDist, spNetwork, reshape2)\n```\n:::\n\n\n# 2 Data Preparation (Geospatial)\n\n## 2.1 Data Import\n\nLet’s begin by introducing and preparing our geospatial data set in R!\n\nTo import geospatial data, we will be using st_read() from the sf package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz2019 <- st_read(\"data/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz2019\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 10 features:\n     Name\n1   kml_1\n2   kml_2\n3   kml_3\n4   kml_4\n5   kml_5\n6   kml_6\n7   kml_7\n8   kml_8\n9   kml_9\n10 kml_10\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Description\n1          <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>12</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>DEPOT ROAD</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ12</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>C22DED671DE2A940</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n2          <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>2</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ02</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>085EF219A5A1AEAD</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n3                 <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>3</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>CHINATOWN</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>OTSZ03</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>OUTRAM</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>OT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>EF2B9A91AF49E025</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n4            <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>4</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>PHILLIP</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ04</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>615D4EDDEF809F8E</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n5      <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>5</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>RAFFLES PLACE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ05</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>72107B11807074F4</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n6              <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>4</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>CHINA SQUARE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>OTSZ04</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>OUTRAM</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>OT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>B609DF5587626C8F</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n7         <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>10</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>TIONG BAHRU</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ10</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>A0FB4B68155D164A</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n8  <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>12</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>BAYFRONT SUBZONE</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ12</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>197F5E664DA4D5E1</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n9  <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>4</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>TIONG BAHRU STATION</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BMSZ04</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT MERAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BM</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>91FFE927ABE3E4DB</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n10     <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>6</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>CLIFFORD PIER</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>DTSZ06</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>Y</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>DOWNTOWN CORE</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>DT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>945CC212CA80626F</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>\n                         geometry\n1  MULTIPOLYGON Z (((103.8145 ...\n2  MULTIPOLYGON Z (((103.8221 ...\n3  MULTIPOLYGON Z (((103.8438 ...\n4  MULTIPOLYGON Z (((103.8496 ...\n5  MULTIPOLYGON Z (((103.8525 ...\n6  MULTIPOLYGON Z (((103.8486 ...\n7  MULTIPOLYGON Z (((103.8311 ...\n8  MULTIPOLYGON Z (((103.8589 ...\n9  MULTIPOLYGON Z (((103.8283 ...\n10 MULTIPOLYGON Z (((103.8552 ...\n```\n:::\n:::\n\n\nFrom the above, we can see that the mpsz2019 data is a multipolygon data in geodetic CRS WGS84, with Z dimensions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services <- st_read(dsn = \"/Users/binhui-ong/IS415-GAA/Take-home_Ex/Take-home_Ex03/data\",\n                              layer = \"ELDERCARE\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID ADDRESSBLO ADDRESSBUI ADDRESSPOS\n1         1       <NA>       <NA>     601318\n2         2       <NA>       <NA>     462509\n3         3       <NA>       <NA>     640190\n4         4       <NA>       <NA>     190005\n5         5       <NA>       <NA>     160044\n6         6       <NA>       <NA>     160117\n7         7       <NA>       <NA>     523499\n8         8       <NA>       <NA>     731569\n9         9       <NA>       <NA>     651210\n10       10       <NA>       <NA>     540182\n                              ADDRESSSTR ADDRESSTYP DESCRIPTIO HYPERLINK\n1      318A Jurong East Avenue 1 #02-308       <NA>       <NA>      <NA>\n2  Blk 509B Bedok North Street 3 #02-157       <NA>       <NA>      <NA>\n3         Blk 190 Boon Lay Drive #01-242       <NA>       <NA>      <NA>\n4                    5 Beach Rd #02-4943       <NA>       <NA>      <NA>\n5             Blk 44 Beo Crescent #01-67       <NA>       <NA>      <NA>\n6     Blk 117 Jalan Bukit Merah #01-1683       <NA>       <NA>      <NA>\n7            499C Tampines Ave 9 #01-256       <NA>       <NA>      <NA>\n8              569A Champion Way #01-346       <NA>       <NA>      <NA>\n9         210A Bukit Batok St 21 #01-294       <NA>       <NA>      <NA>\n10   Blk 182 Rivervale Crescent\\n#01-311       <NA>       <NA>      <NA>\n   LANDXADDRE LANDYADDRE\n1           0          0\n2           0          0\n3           0          0\n4           0          0\n5           0          0\n6           0          0\n7           0          0\n8           0          0\n9           0          0\n10          0          0\n                                                           NAME PHOTOURL\n1                                  Yuhua Senior Activity Centre     <NA>\n2                                          THK SAC @ Kaki Bukit     <NA>\n3                                            THK SAC @ Boon Lay     <NA>\n4                        PEACE-Connect Senior Activity Centre@5     <NA>\n5                                        THK SAC @ Beo Crescent     <NA>\n6                                      Silver ACE @ Bukit Merah     <NA>\n7  Lions Befrienders Senior Activity Centre @ Tampines Blk 499C     <NA>\n8                    Care Corner Senior Activity Centre (WL569)     <NA>\n9           Fei Yue Senior Activity Centre (Bukit Batok Branch)     <NA>\n10       COMNET Senior Activity Centre @ 182 Rivervale Crescent     <NA>\n   ADDRESSFLO          INC_CRC FMEL_UPD_D ADDRESSUNI   X_ADDR   Y_ADDR\n1        <NA> 2B0DB92FDD914FFC 2016-07-28       <NA> 16614.08 36639.12\n2        <NA> 82728FA30612F3FD 2016-07-28       <NA> 38803.81 35098.78\n3        <NA> DE7A8D4EA0BD1D9B 2016-07-28       <NA> 14481.92 36357.61\n4        <NA> A2C058FC5785F7FE 2016-07-28       <NA> 31505.35 31853.52\n5        <NA> 9DBFD51E056AEE70 2016-07-28       <NA> 27218.35 30135.49\n6        <NA> 169DABA5B6ECEA87 2016-07-28       <NA> 27278.94 29350.17\n7        <NA> 5DB6B9F0BF276F6D 2016-07-28       <NA> 41665.14 37956.92\n8        <NA> 4DC6800E9BB385BE 2016-07-28       <NA> 23147.94 45761.17\n9        <NA> EFBD712DA5DD6FEC 2016-07-28       <NA> 18820.58 36396.32\n10       <NA> 6BB0D7698D7B4C7D 2016-07-28       <NA> 36446.37 41376.90\n                    geometry\n1  POINT (16614.08 36639.12)\n2  POINT (38803.81 35098.78)\n3  POINT (14481.92 36357.61)\n4  POINT (31505.35 31853.52)\n5  POINT (27218.35 30135.49)\n6  POINT (27278.94 29350.17)\n7  POINT (41665.14 37956.92)\n8  POINT (23147.94 45761.17)\n9  POINT (18820.58 36396.32)\n10  POINT (36446.37 41376.9)\n```\n:::\n:::\n\nThe eldercare_services data set is point data, with dimensions XY and CRS SVY21.\n\nLet's visualize how it looks like using plot() and st_geometry() from the sf package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(mpsz2019))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(eldercare_services))\n```\n:::\n\n\n\n## 2.2 Data Pre-Processing\n\n### 2.2.1 Dropping Z-dimension\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_zm(mpsz2019)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 2.2.2 Resolving invalid geometries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(mpsz) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(eldercare_services) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_make_valid(mpsz)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(which(st_is_valid(mpsz) == FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\n### 2.2.3 Handling missing values\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz[rowSums(is.na(mpsz)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 2 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nGeodetic CRS:  WGS 84\n[1] Name        Description geometry   \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services[rowSums(is.na(eldercare_services)) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID ADDRESSBLO ADDRESSBUI ADDRESSPOS\n1         1       <NA>       <NA>     601318\n2         2       <NA>       <NA>     462509\n3         3       <NA>       <NA>     640190\n4         4       <NA>       <NA>     190005\n5         5       <NA>       <NA>     160044\n6         6       <NA>       <NA>     160117\n7         7       <NA>       <NA>     523499\n8         8       <NA>       <NA>     731569\n9         9       <NA>       <NA>     651210\n10       10       <NA>       <NA>     540182\n                              ADDRESSSTR ADDRESSTYP DESCRIPTIO HYPERLINK\n1      318A Jurong East Avenue 1 #02-308       <NA>       <NA>      <NA>\n2  Blk 509B Bedok North Street 3 #02-157       <NA>       <NA>      <NA>\n3         Blk 190 Boon Lay Drive #01-242       <NA>       <NA>      <NA>\n4                    5 Beach Rd #02-4943       <NA>       <NA>      <NA>\n5             Blk 44 Beo Crescent #01-67       <NA>       <NA>      <NA>\n6     Blk 117 Jalan Bukit Merah #01-1683       <NA>       <NA>      <NA>\n7            499C Tampines Ave 9 #01-256       <NA>       <NA>      <NA>\n8              569A Champion Way #01-346       <NA>       <NA>      <NA>\n9         210A Bukit Batok St 21 #01-294       <NA>       <NA>      <NA>\n10   Blk 182 Rivervale Crescent\\n#01-311       <NA>       <NA>      <NA>\n   LANDXADDRE LANDYADDRE\n1           0          0\n2           0          0\n3           0          0\n4           0          0\n5           0          0\n6           0          0\n7           0          0\n8           0          0\n9           0          0\n10          0          0\n                                                           NAME PHOTOURL\n1                                  Yuhua Senior Activity Centre     <NA>\n2                                          THK SAC @ Kaki Bukit     <NA>\n3                                            THK SAC @ Boon Lay     <NA>\n4                        PEACE-Connect Senior Activity Centre@5     <NA>\n5                                        THK SAC @ Beo Crescent     <NA>\n6                                      Silver ACE @ Bukit Merah     <NA>\n7  Lions Befrienders Senior Activity Centre @ Tampines Blk 499C     <NA>\n8                    Care Corner Senior Activity Centre (WL569)     <NA>\n9           Fei Yue Senior Activity Centre (Bukit Batok Branch)     <NA>\n10       COMNET Senior Activity Centre @ 182 Rivervale Crescent     <NA>\n   ADDRESSFLO          INC_CRC FMEL_UPD_D ADDRESSUNI   X_ADDR   Y_ADDR\n1        <NA> 2B0DB92FDD914FFC 2016-07-28       <NA> 16614.08 36639.12\n2        <NA> 82728FA30612F3FD 2016-07-28       <NA> 38803.81 35098.78\n3        <NA> DE7A8D4EA0BD1D9B 2016-07-28       <NA> 14481.92 36357.61\n4        <NA> A2C058FC5785F7FE 2016-07-28       <NA> 31505.35 31853.52\n5        <NA> 9DBFD51E056AEE70 2016-07-28       <NA> 27218.35 30135.49\n6        <NA> 169DABA5B6ECEA87 2016-07-28       <NA> 27278.94 29350.17\n7        <NA> 5DB6B9F0BF276F6D 2016-07-28       <NA> 41665.14 37956.92\n8        <NA> 4DC6800E9BB385BE 2016-07-28       <NA> 23147.94 45761.17\n9        <NA> EFBD712DA5DD6FEC 2016-07-28       <NA> 18820.58 36396.32\n10       <NA> 6BB0D7698D7B4C7D 2016-07-28       <NA> 36446.37 41376.90\n                    geometry\n1  POINT (16614.08 36639.12)\n2  POINT (38803.81 35098.78)\n3  POINT (14481.92 36357.61)\n4  POINT (31505.35 31853.52)\n5  POINT (27218.35 30135.49)\n6  POINT (27278.94 29350.17)\n7  POINT (41665.14 37956.92)\n8  POINT (23147.94 45761.17)\n9  POINT (18820.58 36396.32)\n10  POINT (36446.37 41376.9)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare_services[rowSums(is.na(eldercare_services %>% select(11,19))) != 0, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 0 features and 18 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nProjected CRS: SVY21\n [1] OBJECTID   ADDRESSBLO ADDRESSBUI ADDRESSPOS ADDRESSSTR ADDRESSTYP\n [7] DESCRIPTIO HYPERLINK  LANDXADDRE LANDYADDRE NAME       PHOTOURL  \n[13] ADDRESSFLO INC_CRC    FMEL_UPD_D ADDRESSUNI X_ADDR     Y_ADDR    \n[19] geometry  \n<0 rows> (or 0-length row.names)\n```\n:::\n:::\n\n\n### 2.2.4 Changing and verifying CRS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(mpsz)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n:::\n:::\n\nThe mpsz data set is not in our desired coordinate system (SVY21; EPSG: 3414). Hence, we need to reproject it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(eldercare_services)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n```\n:::\n:::\n\n\nThe eldercare_services data set does not have the correct EPSG code (3414). Hence, we must reassign the EPSG code to it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf <- st_transform(mpsz, 3414)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare <- st_set_crs(eldercare_services, 3414)\n```\n:::\n\n\n### 2.2.6 Extraction of relevant columns\n\n#### 2.2.6.1 Extraction of subzone and planning area names in mpsz_sf\n\nFor subzone: \n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf <- mpsz_sf %>%  \n  rowwise() %>%\n  mutate(SUBZONE= str_extract(`Description`, \"<th>SUBZONE_N</th> <td>(.*?)</td>\")) %>% ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf$SUBZONE <- str_remove_all(mpsz_sf$SUBZONE, \"<.*?>|SUBZONE_N\")\n```\n:::\n\n\nFor planning area:\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf <- mpsz_sf %>%  \n  rowwise() %>%\n  mutate(PLAN_AREA= str_extract(`Description`, \"<th>PLN_AREA_N</th> <td>(.*?)</td>\")) %>% ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf$PLAN_AREA <- str_remove_all(mpsz_sf$PLAN_AREA, \"<.*?>|PLN_AREA_N\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 332 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.537 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 332 × 5\n   Name   Description                                 geometry SUBZONE PLAN_AREA\n * <chr>  <chr>                             <MULTIPOLYGON [m]> <chr>   <chr>    \n 1 kml_1  \"<center><table><tr><th c… (((25880.34 29441.11, 25… \" DEPO… \" BUKIT …\n 2 kml_2  \"<center><table><tr><th c… (((26750.09 29224.02, 26… \" BUKI… \" BUKIT …\n 3 kml_3  \"<center><table><tr><th c… (((29147.2 29734.55, 291… \" CHIN… \" OUTRAM\"\n 4 kml_4  \"<center><table><tr><th c… (((29814.87 29619.28, 29… \" PHIL… \" DOWNTO…\n 5 kml_5  \"<center><table><tr><th c… (((30118.74 29880.81, 30… \" RAFF… \" DOWNTO…\n 6 kml_6  \"<center><table><tr><th c… (((29701.93 29421.63, 29… \" CHIN… \" OUTRAM\"\n 7 kml_7  \"<center><table><tr><th c… (((27628.62 29979.7, 275… \" TION… \" BUKIT …\n 8 kml_8  \"<center><table><tr><th c… (((30895.45 29098.9, 309… \" BAYF… \" DOWNTO…\n 9 kml_9  \"<center><table><tr><th c… (((27413.67 29966.31, 27… \" TION… \" BUKIT …\n10 kml_10 \"<center><table><tr><th c… (((30444.3 29529.22, 304… \" CLIF… \" DOWNTO…\n# ℹ 322 more rows\n```\n:::\n:::\n\n\n#### 2.2.6.2 Keeping only relevant columns in eldercare\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare <- eldercare %>% select(11,19)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neldercare\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 133 features and 1 field\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                                                           NAME\n1                                  Yuhua Senior Activity Centre\n2                                          THK SAC @ Kaki Bukit\n3                                            THK SAC @ Boon Lay\n4                        PEACE-Connect Senior Activity Centre@5\n5                                        THK SAC @ Beo Crescent\n6                                      Silver ACE @ Bukit Merah\n7  Lions Befrienders Senior Activity Centre @ Tampines Blk 499C\n8                    Care Corner Senior Activity Centre (WL569)\n9           Fei Yue Senior Activity Centre (Bukit Batok Branch)\n10       COMNET Senior Activity Centre @ 182 Rivervale Crescent\n                    geometry\n1  POINT (16614.08 36639.12)\n2  POINT (38803.81 35098.78)\n3  POINT (14481.92 36357.61)\n4  POINT (31505.35 31853.52)\n5  POINT (27218.35 30135.49)\n6  POINT (27278.94 29350.17)\n7  POINT (41665.14 37956.92)\n8  POINT (23147.94 45761.17)\n9  POINT (18820.58 36396.32)\n10  POINT (36446.37 41376.9)\n```\n:::\n:::\n\n\n### 2.2.7 Creating hexagon data (******** NEED TO WORK HERE*****)\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n# 3 Data Preparation (Distance Matrix)\n\nThe first step to dealing with our aspatial data is to import it into our R environment. To do so, we can use read_csv() from the readr package.\n\n## 3.1 Computing Distance Matrix\n\n### 3.1.1 Converting from sf data.table to SpatialPolygonsDataFrame\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sp <- as(mpsz_sf, \"Spatial\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatialPolygonsDataFrame \nfeatures    : 332 \nextent      : 2667.537, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 4\nnames       :   Name,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Description,    SUBZONE,   PLAN_AREA \nmin values  :  kml_1, <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>1</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>ANAK BUKIT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>BTSZ01</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>BUKIT TIMAH</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>BT</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>CENTRAL REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>CR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>4BAD8B2C9CEBF3F2</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>,  ADMIRALTY,  ANG MO KIO \nmax values  : kml_99,       <center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_NO</th> <td>9</td> </tr><tr bgcolor=\"\"> <th>SUBZONE_N</th> <td>YISHUN WEST</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>SUBZONE_C</th> <td>YSSZ09</td> </tr><tr bgcolor=\"\"> <th>CA_IND</th> <td>N</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>PLN_AREA_N</th> <td>YISHUN</td> </tr><tr bgcolor=\"\"> <th>PLN_AREA_C</th> <td>YS</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>REGION_N</th> <td>NORTH REGION</td> </tr><tr bgcolor=\"\"> <th>REGION_C</th> <td>NR</td> </tr><tr bgcolor=\"#E3E3F3\"> <th>INC_CRC</th> <td>95C11920195B86C7</td> </tr><tr bgcolor=\"\"> <th>FMEL_UPD_D</th> <td>20191223152313</td> </tr></table></center>,     YUNNAN,      YISHUN \n```\n:::\n:::\n\n\n### 3.1.2 Computing the distance matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist_matrix <- spDists(mpsz_sp, longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(dist_matrix, n = c(10,10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      DEPOT ROAD  BUKIT MERAH  CHINATOWN   PHILLIP\n DEPOT ROAD                0.000    1116.5222  3917.3813 4474.9751\n BUKIT MERAH            1116.522       0.0000  2802.3046 3365.3170\n CHINATOWN              3917.381    2802.3046     0.0000  806.1938\n PHILLIP                4474.975    3365.3170   806.1938    0.0000\n RAFFLES PLACE          4727.007    3612.7458   914.1374  313.4049\n CHINA SQUARE           4271.839    3159.7516   604.1898  220.3051\n TIONG BAHRU            2547.759    1439.7243  1434.9775 1927.2539\n BAYFRONT SUBZONE       5563.087    4447.8391  1693.6594 1120.2910\n TIONG BAHRU STATION    2042.758     943.3764  1929.4646 2433.1646\n CLIFFORD PIER          5148.250    4037.8038  1372.7121  673.5165\n                      RAFFLES PLACE  CHINA SQUARE  TIONG BAHRU\n DEPOT ROAD               4727.0065     4271.8390    2547.7587\n BUKIT MERAH              3612.7458     3159.7516    1439.7243\n CHINATOWN                 914.1374      604.1898    1434.9775\n PHILLIP                   313.4049      220.3051    1927.2539\n RAFFLES PLACE               0.0000      464.8507    2183.0161\n CHINA SQUARE              464.8507        0.0000    1724.8823\n TIONG BAHRU              2183.0161     1724.8823       0.0000\n BAYFRONT SUBZONE          838.7051     1301.7999    3021.1681\n TIONG BAHRU STATION      2691.3674     2232.5240     508.4764\n CLIFFORD PIER             458.5921      879.5155    2600.4915\n                      BAYFRONT SUBZONE  TIONG BAHRU STATION  CLIFFORD PIER\n DEPOT ROAD                  5563.0874            2042.7580      5148.2501\n BUKIT MERAH                 4447.8391             943.3764      4037.8038\n CHINATOWN                   1693.6594            1929.4646      1372.7121\n PHILLIP                     1120.2910            2433.1646       673.5165\n RAFFLES PLACE                838.7051            2691.3674       458.5921\n CHINA SQUARE                1301.7999            2232.5240       879.5155\n TIONG BAHRU                 3021.1681             508.4764      2600.4915\n BAYFRONT SUBZONE               0.0000            3529.6090       492.6994\n TIONG BAHRU STATION         3529.6090               0.0000      3106.6555\n CLIFFORD PIER                492.6994            3106.6555         0.0000\n```\n:::\n:::\n\n\n### 3.1.3 Labelling column and row headers of a distance matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsz_names <- mpsz_sf$SUBZONE\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(dist_matrix) <- paste0(sz_names)\nrownames(dist_matrix) <- paste0(sz_names)\n```\n:::\n\n\n\n### 3.1.4 Pivoting distance value by SUBZONE name\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(distPair)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          origin        dest     dist\n1     DEPOT ROAD  DEPOT ROAD    0.000\n2    BUKIT MERAH  DEPOT ROAD 1116.522\n3      CHINATOWN  DEPOT ROAD 3917.381\n4        PHILLIP  DEPOT ROAD 4474.975\n5  RAFFLES PLACE  DEPOT ROAD 4727.007\n6   CHINA SQUARE  DEPOT ROAD 4271.839\n```\n:::\n:::\n\n\n### 3.1.5 Updating intra-zonal distances\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair %>% filter(dist > 0) %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            origin                   dest             dist        \n  DEPOT ROAD   :   331    DEPOT ROAD   :   331   Min.   :  173.8  \n  BUKIT MERAH  :   331    BUKIT MERAH  :   331   1st Qu.: 7149.5  \n  CHINATOWN    :   331    CHINATOWN    :   331   Median :11890.0  \n  PHILLIP      :   331    PHILLIP      :   331   Mean   :12229.4  \n  RAFFLES PLACE:   331    RAFFLES PLACE:   331   3rd Qu.:16401.7  \n  CHINA SQUARE :   331    CHINA SQUARE :   331   Max.   :49894.4  \n (Other)       :107906   (Other)       :107906                    \n```\n:::\n:::\n\n\nFrom the results, we can see that the minimum distance is 173.8m.\n\nNext, a constant distance of 50m is added into the intra-zones distance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair$dist <- ifelse(distPair$dist == 0, 50, distPair$dist)\n```\n:::\n\n\nThe code below can be used to check the result data.frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            origin                   dest             dist      \n  DEPOT ROAD   :   332    DEPOT ROAD   :   332   Min.   :   50  \n  BUKIT MERAH  :   332    BUKIT MERAH  :   332   1st Qu.: 7097  \n  CHINATOWN    :   332    CHINATOWN    :   332   Median :11864  \n  PHILLIP      :   332    PHILLIP      :   332   Mean   :12193  \n  RAFFLES PLACE:   332    RAFFLES PLACE:   332   3rd Qu.:16388  \n  CHINA SQUARE :   332    CHINA SQUARE :   332   Max.   :49894  \n (Other)       :108232   (Other)       :108232                  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndistmat_km <- as.matrix(dist_matrix/1000)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n# 4 Modelling and Visualizing Accesssibility using Hansen Method (requires hexagon)\n\n## 4.1 Computing Hansen's accessibility (requires hexagon)\n\n\n::: {.cell}\n\n:::\n\n\n## 4.2 Visualizing Hansen's accessibility \n\n### 4.2.1 Extracting map extend (requires hexagon)\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 4.3 Statistical graphic visualization\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}